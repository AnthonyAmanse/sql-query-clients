
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18: http://docutils.sourceforge.net/" />

    <title>SQLQuery Class &#8212; ibmcloudsql alpha documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/js/custom.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="COSClient Class" href="cos.html" />
    <link rel="prev" title="Introduction" href="intro.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ibmcloudsql</a></h1>








<h3>Navigation</h3>
<p><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SQLQuery Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#help">Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="#submit-sql-jobs">Submit SQL jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#work-with-query-results">Work with query results</a></li>
<li class="toctree-l2"><a class="reference internal" href="#manage-jobs">Manage jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#manage-cloud-object-storage-url">Manage Cloud Object Storage URL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#manage-table-catalog">Manage table catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-skipping">Data skipping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tips">Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#sqlclienttimeseries-class">SQLClientTimeSeries Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prepare-data-for-time-series">Prepare data for time series</a></li>
<li class="toctree-l2"><a class="reference internal" href="#user-friendly-sql-string">User-friendly SQL string</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cos.html">COSClient Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="sql_magic.html">SQLBuilder Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">IBMCloudAccess Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="includeme.html">Github Repository</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="intro.html" title="previous chapter">Introduction</a></li>
      <li>Next: <a href="cos.html" title="next chapter">COSClient Class</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="sqlquery-class">
<span id="sql-query-label"></span><h1>SQLQuery Class<a class="headerlink" href="#sqlquery-class" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="ibmcloudsql.html#module-ibmcloudsql.SQLQuery" title="ibmcloudsql.SQLQuery"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ibmcloudsql.SQLQuery</span></code></a> provides the following single class:</p>
<ul class="simple">
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery" title="ibmcloudsql.SQLQuery.SQLQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLQuery</span></code></a> class</p></li>
</ul>
<p>An <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery" title="ibmcloudsql.SQLQuery.SQLQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLQuery</span></code></a> class is also a <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.cos.COSClient" title="ibmcloudsql.cos.COSClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">COSClient</span></code></a> class, and an <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.sql_magic.SQLBuilder" title="ibmcloudsql.sql_magic.SQLBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLBuilder</span></code></a> class.
This way the <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery" title="ibmcloudsql.SQLQuery.SQLQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLQuery</span></code></a> class acts as the central consolidated API interface for the entire ibmcloudsql module.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sqlClient</span> <span class="o">=</span> <span class="n">SQLQuery</span><span class="p">(</span><span class="o">....</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery" title="ibmcloudsql.SQLQuery.SQLQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLQuery</span></code></a> (…): instantiate with initial settings</p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.configure" title="ibmcloudsql.SQLQuery.SQLQuery.configure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SQLQuery.configure()</span></code></a>: update the setting</p></li>
</ol>
<section id="help">
<h2>Help<a class="headerlink" href="#help" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.analyze" title="ibmcloudsql.SQLQuery.SQLQuery.analyze"><code class="xref py py-meth docutils literal notranslate"><span class="pre">analyze()</span></code></a>: If you are stuck with a query that takes too long, try this one. It may provide you with suggestions on how to improve your query or revise your data source.</p></li>
</ol>
</section>
<section id="submit-sql-jobs">
<h2>Submit SQL jobs<a class="headerlink" href="#submit-sql-jobs" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.submit_sql" title="ibmcloudsql.SQLQuery.SQLQuery.submit_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SQLQuery.submit_sql()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.run_sql" title="ibmcloudsql.SQLQuery.SQLQuery.run_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SQLQuery.run_sql()</span></code></a>, <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.execute_sql" title="ibmcloudsql.SQLQuery.SQLQuery.execute_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SQLQuery.execute_sql()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.submit_and_track_sql" title="ibmcloudsql.SQLQuery.SQLQuery.submit_and_track_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit_and_track_sql()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.get_schema_data" title="ibmcloudsql.SQLQuery.SQLQuery.get_schema_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_schema_data()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.submit" title="ibmcloudsql.SQLQuery.SQLQuery.submit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit()</span></code></a> and <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.run" title="ibmcloudsql.SQLQuery.SQLQuery.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a>: The two new methods run an SQL statement generated by the approach provided by <code class="xref py py-class docutils literal notranslate"><span class="pre">SQLBuilder</span></code> class.</p></li>
</ol>
</section>
<section id="work-with-query-results">
<h2>Work with query results<a class="headerlink" href="#work-with-query-results" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.get_result" title="ibmcloudsql.SQLQuery.SQLQuery.get_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_result()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.delete_result" title="ibmcloudsql.SQLQuery.SQLQuery.delete_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_result()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result" title="ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rename_exact_result()</span></code></a>: Modify the created objects on Cloud Object Storage.</p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result_joblist" title="ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result_joblist"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rename_exact_result_joblist()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.cos.COSClient.delete_empty_objects" title="ibmcloudsql.cos.COSClient.delete_empty_objects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_empty_objects()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.list_results" title="ibmcloudsql.SQLQuery.SQLQuery.list_results"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list_results()</span></code></a></p></li>
</ol>
</section>
<section id="manage-jobs">
<h2>Manage jobs<a class="headerlink" href="#manage-jobs" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.my_jobs" title="ibmcloudsql.SQLQuery.SQLQuery.my_jobs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">my_jobs()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.wait_for_job" title="ibmcloudsql.SQLQuery.SQLQuery.wait_for_job"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wait_for_job()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.process_failed_jobs_until_all_completed" title="ibmcloudsql.SQLQuery.SQLQuery.process_failed_jobs_until_all_completed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_failed_jobs_until_all_completed()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.get_job" title="ibmcloudsql.SQLQuery.SQLQuery.get_job"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_job()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.get_jobs" title="ibmcloudsql.SQLQuery.SQLQuery.get_jobs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_jobs()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.get_number_running_jobs" title="ibmcloudsql.SQLQuery.SQLQuery.get_number_running_jobs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_number_running_jobs()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.get_jobs_with_status" title="ibmcloudsql.SQLQuery.SQLQuery.get_jobs_with_status"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_jobs_with_status()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.get_jobs_count_with_status" title="ibmcloudsql.SQLQuery.SQLQuery.get_jobs_count_with_status"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_jobs_count_with_status()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.export_job_history" title="ibmcloudsql.SQLQuery.SQLQuery.export_job_history"><code class="xref py py-meth docutils literal notranslate"><span class="pre">export_job_history()</span></code></a></p></li>
</ol>
</section>
<section id="manage-cloud-object-storage-url">
<h2>Manage Cloud Object Storage URL<a class="headerlink" href="#manage-cloud-object-storage-url" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.cos.COSClient" title="ibmcloudsql.cos.COSClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">COSClient</span></code></a></p>
</section>
<section id="manage-table-catalog">
<h2>Manage table catalog<a class="headerlink" href="#manage-table-catalog" title="Permalink to this headline">¶</a></h2>
<p>From <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.catalog_table.HiveMetastore" title="ibmcloudsql.catalog_table.HiveMetastore"><code class="xref py py-class docutils literal notranslate"><span class="pre">HiveMetastore</span></code></a></p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.catalog_table.HiveMetastore.show_tables" title="ibmcloudsql.catalog_table.HiveMetastore.show_tables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">show_tables()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.catalog_table.HiveMetastore.drop_all_tables" title="ibmcloudsql.catalog_table.HiveMetastore.drop_all_tables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drop_all_tables()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.catalog_table.HiveMetastore.drop_tables" title="ibmcloudsql.catalog_table.HiveMetastore.drop_tables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drop_tables()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.catalog_table.HiveMetastore.drop_table" title="ibmcloudsql.catalog_table.HiveMetastore.drop_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drop_table()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.catalog_table.HiveMetastore.create_table" title="ibmcloudsql.catalog_table.HiveMetastore.create_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_table()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.catalog_table.HiveMetastore.create_partitioned_table" title="ibmcloudsql.catalog_table.HiveMetastore.create_partitioned_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_partitioned_table()</span></code></a>: For partitioned tables.</p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.catalog_table.HiveMetastore.recover_table_partitions" title="ibmcloudsql.catalog_table.HiveMetastore.recover_table_partitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">recover_table_partitions()</span></code></a></p></li>
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.catalog_table.HiveMetastore.describe_table" title="ibmcloudsql.catalog_table.HiveMetastore.describe_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">describe_table()</span></code></a></p></li>
</ol>
</section>
<section id="data-skipping">
<h2>Data skipping<a class="headerlink" href="#data-skipping" title="Permalink to this headline">¶</a></h2>
<p>[Not available yet]</p>
</section>
<section id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The SQL statement string size limit is 200KB.</p></li>
<li><p>Maximum five concurrent SQL queries for a standard SQL Query instance.</p></li>
<li><p>Maximum duration of one hour for a query job. However, many jobs can be stopped much earlier due to the current mechanism of AIM token timeout, and this token is shared across all current SQL queries.</p></li>
</ul>
</section>
<section id="tips">
<h2>Tips<a class="headerlink" href="#tips" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>Combine the SQL query if you can, as there is an overhead (and possibly $ cost) for a REST API request. However, also consider the current limit for a YARN executor of 7.5GB, so design the SQL query accordingly. It is best if the data being accessed is organized with multiple objects of ideal sizes (see below), since this enables more parallelism in the Object Storage.</p></li>
<li><p>Complex data can only be stored using Json or Parquet, it is faster with Parquet.</p></li>
<li><p>Avoid storing the data with a single object’s size larger than 200MB. To check, consider using <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.cos.COSClient.get_cos_summary" title="ibmcloudsql.cos.COSClient.get_cos_summary"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_cos_summary()</span></code></a> or <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery.list_results" title="ibmcloudsql.SQLQuery.SQLQuery.list_results"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list_results()</span></code></a>. To resolve the issue, consider using the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>Partition table into multiple buckets/objects type-1: PARTITION INTO &lt;x&gt; BUCKETS/OBJECTS, with maximum allowed for ‘x’ is 50.</p></li>
<li><p>Partition table into multiple buckets/objects type-2: PARTITIONED EVERY &lt;x&gt; ROWS.</p></li>
<li><p>Hive-style partitioning: PARTITION BY (col1, col2, …).</p></li>
</ul>
</div></blockquote>
</li>
<li><p>When partitioning according to a column that has NULL values, Spark will use “__HIVE_DEFAULT_PARTITION__” in the object name, for example,  &lt;bucket&gt;/Location=__HIVE_DEFAULT_PARTITION__/&lt;data-partition&gt;.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sqlClient</span><span class="o">.</span><span class="n">list_results</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ObjectURL       Size    Bucket  Object</span>
<span class="go">0       cos://s3.us-south.cloud-object-storage.appdomain.cloud/sql-query-cos-access-ts/jobid=a3475263-469a-4e22-b382-1d0ae8f1d1fa       0       sql-query-cos-access-ts jobid=a3475263-469a-4e22-b382-1d0ae8f1d1fa</span>
<span class="go">1       cos://s3.us-south.cloud-object-storage.appdomain.cloud/sql-query-cos-access-ts/jobid=a3475263-469a-4e22-b382-1d0ae8f1d1fa/_SUCCESS      0       sql-query-cos-access-ts jobid=a3475263-469a-4e22-b382-1d0ae8f1d1fa/_SUCCESS</span>
<span class="go">2       cos://s3.us-south.cloud-object-storage.appdomain.cloud/sql-query-cos-access-ts/jobid=a3475263-469a-4e22-b382-1d0ae8f1d1fa/part-00000-e299e734-43e3-4032-b27d-b0d7e93d51c2-c000-attempt_20200318152159_0040_m_000000_0.snappy.parquet    7060033106      sql-query-cos-access-ts jobid=a3475263-469a-4e22-b382-1d0ae8f1d1fa/part-00000-e299e734-43e3-4032-b27d-b0d7e93d51c2-c000-attempt_20200318152159_0040_m_000000_0.snappy.parquet</span>
</pre></div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.ibm.com/SqlServiceWdp/sparksql-parser">Sparksql-parser</a>: The module contains code with the know how to parse an SQLCloud-specific statement and transform it into a valid SQL statement.</p></li>
<li><p><a class="reference external" href="https://github.ibm.com/SqlServiceWdp/sparksql-parser/blob/8895a3872790d21e4bb0f0e47a608bfb633e0b2a/antlr/SqlQuery.g4">Grammar</a></p></li>
<li><p><a class="reference external" href="https://www.ibm.com/cloud/blog/big-data-layout">Tips for data layout</a></p></li>
<li><p><a class="reference external" href="https://www.ibm.com/cloud/blog/data-skipping-for-ibm-cloud-sql-query">Data skipping</a></p></li>
</ul>
</section>
</section>
<section id="sqlclienttimeseries-class">
<h1>SQLClientTimeSeries Class<a class="headerlink" href="#sqlclienttimeseries-class" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="ibmcloudsql.html#module-ibmcloudsql.sql_query_ts" title="ibmcloudsql.sql_query_ts"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ibmcloudsql.sql_query_ts</span></code></a> provides the <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.sql_query_ts.SQLClientTimeSeries" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLClientTimeSeries</span></code></a> class which is derived from <a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.SQLQuery.SQLQuery" title="ibmcloudsql.SQLQuery.SQLQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLQuery</span></code></a> class. The class provides APIs to make it easier to issue SQL statement that contains time-series functions.</p>
<section id="prepare-data-for-time-series">
<h2>Prepare data for time series<a class="headerlink" href="#prepare-data-for-time-series" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="ibmcloudsql.html#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.get_ts_datasource" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.get_ts_datasource"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_ts_datasource()</span></code></a></p></li>
</ul>
<p>Let’s assume that you create a HIVE catalog table to store the data for fast access that is used as the data source via <cite>table_name</cite> argument.</p>
<p>A time series is comprised of the following:</p>
<ol class="arabic simple">
<li><p>The <cite>time_stamp</cite> information.</p></li>
<li><p>The <cite>observation</cite> information.</p></li>
<li><p>Category, for example, the <cite>key</cite>.</p></li>
</ol>
<p>Very often, the raw data is too dense to be digested into a time series. Such data has to be transformed into a coarser timescale, using a proper aggregated function, for example, avg() or max(). The time window during which the summarized data point is to be collected is given by passing a value to <cite>granularity</cite> argument, as in the following example:</p>
<ul class="simple">
<li><p><cite>raw</cite>: No change, just extract to a new location.</p></li>
<li><p><cite>per_sec</cite>, or <cite>PT1S</cite>: Per every second.</p></li>
<li><p><cite>per_2sec</cite>, or <cite>PT2S</cite>: Per every two seconds.</p></li>
<li><p><cite>per_min</cite>, or <cite>PT1M</cite>: Per every minute.</p></li>
<li><p><cite>per_5min</cite>, or <cite>PT5M</cite>: Per every five minutes.</p></li>
</ul>
<p>In general, a valid value to <cite>granularity</cite> follows the following conventions:</p>
<ul class="simple">
<li><p>‘per_[x]sec’ and ‘per_[x]min’ with x is divisible by 60</p></li>
<li><p>ISO 8601 duration standard</p></li>
</ul>
<p>The transformed data is then copied and saved into a new location (the time-series data source), which is specified by the following:</p>
<ul class="simple">
<li><p><cite>cos_out</cite>: Cloud Object Storage URL (stored as PARQUET).</p></li>
<li><p><cite>num_objects</cite>: Split into multiple objects.</p></li>
<li><p><cite>num_rows</cite>: Split into multiple objects based on number of rows per object.</p></li>
</ul>
<p><strong>At the end of the transformation</strong>, the data source to be used for time series creation comprises the following three columns:</p>
<ul class="simple">
<li><p><cite>field_name</cite>: Representing category.</p></li>
<li><p><cite>time_stamp</cite>: Representing the point of time at the given granularity.</p></li>
<li><p><cite>observation</cite>: Representing the recorded information.</p></li>
</ul>
<p>If you use a generic name, you can quickly apply it to any data source.</p>
</section>
<section id="user-friendly-sql-string">
<h2>User-friendly SQL string<a class="headerlink" href="#user-friendly-sql-string" title="Permalink to this headline">¶</a></h2>
<p>Several time-series functions being used in CloudSQL accept parameters in the unit of mili-seconds, which is not user-friendly.
The class provides the built-in functionality to map user-friendly name such as <cite>hour</cite>, <cite>day</cite>, <cite>2hour</cite>, <cite>week</cite> into the right unit, before sending the query to CloudSQL service.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020, IBM Research.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/sql_query.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>