
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18: http://docutils.sourceforge.net/" />

    <title>ibmcloudsql package &#8212; ibmcloudsql alpha documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/js/custom.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Github Repository" href="includeme.html" />
    <link rel="prev" title="API Reference" href="modules.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ibmcloudsql</a></h1>








<h3>Navigation</h3>
<p><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="sql_query.html">SQLQuery Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="sql_query.html#sqlclienttimeseries-class">SQLClientTimeSeries Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="cos.html">COSClient Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="sql_magic.html">SQLBuilder Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">IBMCloudAccess Class</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ibmcloudsql package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ibmcloudsql.SQLQuery">SQL Query module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ibmcloudsql.catalog_table">Catalog/Table module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ibmcloudsql.cos">Cloud Object Storage module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ibmcloudsql.exceptions">Exceptions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ibmcloudsql.sql_magic">Magic module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ibmcloudsql.sql_query_ts">Time-Series SQL Query module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ibmcloudsql.utilities">Utilities module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ibmcloudsql">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="includeme.html">Github Repository</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">API Reference</a><ul>
      <li>Previous: <a href="modules.html" title="previous chapter">API Reference</a></li>
      <li>Next: <a href="includeme.html" title="next chapter">Github Repository</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ibmcloudsql-package">
<h1>ibmcloudsql package<a class="headerlink" href="#ibmcloudsql-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-ibmcloudsql.SQLQuery">
<span id="sql-query-module"></span><h2>SQL Query module<a class="headerlink" href="#module-ibmcloudsql.SQLQuery" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibmcloudsql.SQLQuery.SQLQuery">
<em class="property">class </em><code class="sig-prename descclassname">ibmcloudsql.SQLQuery.</code><code class="sig-name descname">SQLQuery</code><span class="sig-paren">(</span><em class="sig-param">api_key</em>, <em class="sig-param">instance_crn</em>, <em class="sig-param">target_cos_url=None</em>, <em class="sig-param">client_info='IBM Cloud SQL Query Python SDK'</em>, <em class="sig-param">thread_safe=False</em>, <em class="sig-param">max_concurrent_jobs=4</em>, <em class="sig-param">max_tries=1</em>, <em class="sig-param">iam_max_tries=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ibmcloudsql.cos.COSClient" title="ibmcloudsql.cos.COSClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">ibmcloudsql.cos.COSClient</span></code></a>, <a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder" title="ibmcloudsql.sql_magic.SQLBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">ibmcloudsql.sql_magic.SQLBuilder</span></code></a>, <a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore" title="ibmcloudsql.catalog_table.HiveMetastore"><code class="xref py py-class docutils literal notranslate"><span class="pre">ibmcloudsql.catalog_table.HiveMetastore</span></code></a></p>
<p>The class the provides necessary APIs to interact with</p>
<ol class="arabic simple">
<li><p>IBM SQL Serverless service</p></li>
<li><p>IBM COS service</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>apikey</strong><span class="classifier">str, optional</span></dt><dd><p>an account-level API key [manage/Access (IAM)/IBM Cloud API keys]</p>
</dd>
<dt><strong>instance_crn :str, optional</strong></dt><dd><p>CRN from SQLQuery instance</p>
</dd>
<dt><strong>target_cos_url</strong><span class="classifier">str, optional</span></dt><dd><p>the URI where retrieved data is stored</p>
</dd>
<dt><strong>max_concurrent_jobs: int, optional</strong></dt><dd><p>the max number of concurrent jobs</p>
</dd>
<dt><strong>client_info</strong><span class="classifier">str, optional</span></dt><dd><p>User-defined string</p>
</dd>
<dt><strong>max_tries: int, optional</strong></dt><dd><p>The number of time <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.submit_sql" title="ibmcloudsql.SQLQuery.SQLQuery.submit_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit_sql()</span></code></a>, should try to request CloudSQL before giving up.</p>
</dd>
<dt><strong>iam_max_tries: int, optional</strong></dt><dd><p>The number of times to request credential from IAM. By default, token is returned from a request to <cite>iam.cloud.ibm.com</cite> which may not be responsive (i.e. timeout=5 seconds). This parameter controls how many times to try.</p>
</dd>
<dt><strong>thread_safe: bool, optional (=False)</strong></dt><dd><p>If thread-safe is used, a new Session object is created upon this object creation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">columns_in_unixtime</span></code></dt><dd><p>Return the name of columns whose values are in UNIX timestamp</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">cos_session</span></code></dt><dd><p>Get the current COS session.</p>
</dd>
<dt><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.my_jobs" title="ibmcloudsql.SQLQuery.SQLQuery.my_jobs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">my_jobs</span></code></a></dt><dd><p>Return information about jobs already queried via <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_job" title="ibmcloudsql.SQLQuery.SQLQuery.get_job"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_job()</span></code></a></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">project_lib</span></code></dt><dd><p>Project: IBM Watson Studio ProjectLib object</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">target_url</span></code></dt><dd><p>Return the target COS URL.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">thread_safe</span></code></dt><dd><p>Check if SQLQuery is in thread-safe mode.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_partitions</span></code>(table_name, col_names)</p></td>
<td><p>Update the table with a partition column having new value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.analyze" title="ibmcloudsql.SQLQuery.SQLQuery.analyze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">analyze</span></code></a>(job_id[, print_msg])</p></td>
<td><p>Provides some insights about the data layout from the current SQL statement</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">analyze_cos_url</span></code>(cos_url)</p></td>
<td><p>return a namedtuple containing the 3 fields</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.configure" title="ibmcloudsql.SQLQuery.SQLQuery.configure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">configure</span></code></a>([apikey, instance_crn, cos_out_url])</p></td>
<td><p>update the configuration</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect_project_lib</span></code>(project[, file_name])</p></td>
<td><p>Connect to an IBM Watson Studio Project’s COS bucket for its own assets</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_daily_objects</span></code>(source_cos_url, …[, …])</p></td>
<td><p>Copy all objects from a source location in a per day folder on a target location, with a sliding window buffer of days.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_objects</span></code>(source_path, cos_url)</p></td>
<td><p>Upload a file to a given COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_metaindex</span></code>(table_name)</p></td>
<td><p>Create a metaindex for a given table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_partitioned_table</span></code>(table_name[, …])</p></td>
<td><p>Create a partitioned table for data on COS.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_table</span></code>(table_name[, cos_url, …])</p></td>
<td><p>Create a table for data on COS.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_empty_objects</span></code>(cos_url)</p></td>
<td><p>Delete zero-size objects.Reference to <a class="reference internal" href="#ibmcloudsql.cos.COSClient.list_cos_objects" title="ibmcloudsql.cos.COSClient.list_cos_objects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list_cos_objects()</span></code></a> for further details..</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_objects</span></code>(cos_url[, dry_run, confirm, …])</p></td>
<td><p>delete all objects stored at the given COS URL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.delete_result" title="ibmcloudsql.SQLQuery.SQLQuery.delete_result"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_result</span></code></a>(jobId)</p></td>
<td><p>Delete the COS objects created by a given job-id</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">describe_table</span></code>(table_name)</p></td>
<td><p>Return the schema of a table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_all_tables</span></code>()</p></td>
<td><p>Delete all created tables in the project.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_table</span></code>([table_name])</p></td>
<td><p>Drop a given table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_tables</span></code>(table_names)</p></td>
<td><p>Drop a list of tables.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.execute_sql" title="ibmcloudsql.SQLQuery.SQLQuery.execute_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute_sql</span></code></a>(sql_stmt[, pagesize, …])</p></td>
<td><p>Extend the behavior of <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.run_sql" title="ibmcloudsql.SQLQuery.SQLQuery.run_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_sql()</span></code></a>.It is a blocking call that waits for the job to finish (unlike <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.submit_sql" title="ibmcloudsql.SQLQuery.SQLQuery.submit_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit_sql()</span></code></a>), but it has the following features:.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.export_job_history" title="ibmcloudsql.SQLQuery.SQLQuery.export_job_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">export_job_history</span></code></a>([cos_url, …])</p></td>
<td><p>Export the most recent jobs to COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">format_</span></code>()</p></td>
<td><p>Perform string replacement needed so that the final result is a SQL statement that is accepted by IBM Spark SQL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_cos_</span></code>(cos_url[, format_type, alias, …])</p></td>
<td><p>FROM &lt;cos-url&gt; STORED AS &lt;format_type&gt; AS type [FIELDS TERMINATED BY delimiter] [AS alias] [, &lt;cos-url&gt; AS type [AS alias]]</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_table_</span></code>(table[, alias])</p></td>
<td><p>FROM &lt;table&gt; [AS alias] [, &lt;table&gt; [AS alias]]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_view_</span></code>(sql_stmt)</p></td>
<td><p>FROM (&lt;sql&gt;)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bucket</span></code>(cos_url)</p></td>
<td><p>return the bucket name from COS URL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bucket_info</span></code>(cos_url)</p></td>
<td><p>Return the information of the given bucket</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_cos_summary</span></code>(url)</p></td>
<td><p>Return information for the given COR URL (may include bucket + prefix)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_endpoint</span></code>(cos_url)</p></td>
<td><p>return the endpoint string from COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_exact_url</span></code>(cos_url)</p></td>
<td><p>convert COS URL from using alias to exact URL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_job" title="ibmcloudsql.SQLQuery.SQLQuery.get_job"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_job</span></code></a>(jobId)</p></td>
<td><p>Return the details of the job-id</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_jobs" title="ibmcloudsql.SQLQuery.SQLQuery.get_jobs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_jobs</span></code></a>()</p></td>
<td><p>Return the up-to-30 most recent jobs from the given Cloud API</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_jobs_count_with_status" title="ibmcloudsql.SQLQuery.SQLQuery.get_jobs_count_with_status"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_jobs_count_with_status</span></code></a>(status)</p></td>
<td><p>return the number of jobs in the SQL Query server for the given <cite>status</cite></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_jobs_with_status" title="ibmcloudsql.SQLQuery.SQLQuery.get_jobs_with_status"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_jobs_with_status</span></code></a>(job_id_list, status)</p></td>
<td><p>return the list of job_id, among those provided, that have the given status</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metaindex</span></code>(table_name)</p></td>
<td><p>Get the metaindex of a table.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_number_running_jobs" title="ibmcloudsql.SQLQuery.SQLQuery.get_number_running_jobs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_number_running_jobs</span></code></a>()</p></td>
<td><p>return the number of running jobs in the SQL Query server</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_prefix</span></code>(cos_url)</p></td>
<td><p>return the prefix part from COS URL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_result" title="ibmcloudsql.SQLQuery.SQLQuery.get_result"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_result</span></code></a>(jobId[, pagenumber])</p></td>
<td><p>Return the queried data from the given job-id</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_schema_data" title="ibmcloudsql.SQLQuery.SQLQuery.get_schema_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_schema_data</span></code></a>(cos_url[, typ, dry_run])</p></td>
<td><p>Return the schema of COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_schema_table</span></code>(table_name)</p></td>
<td><p>Return the schema of table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sql</span></code>()</p></td>
<td><p>Return the current sql string</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">group_by_</span></code>(columns)</p></td>
<td><p>GROUP BY &lt;columns&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.is_a_supported_storage_type" title="ibmcloudsql.SQLQuery.SQLQuery.is_a_supported_storage_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_a_supported_storage_type</span></code></a>(typ)</p></td>
<td><p>check if a type is in a supported format</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_valid_cos_url</span></code>(cos_url)</p></td>
<td><p>Validate if a string is COS URL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">join_cos_</span></code>(cos_url, condition[, typ, alias])</p></td>
<td><p>[typ] JOIN &lt;cos-url&gt; [AS alias]</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">join_table_</span></code>(table, condition[, typ, alias])</p></td>
<td><p>[typ] JOIN &lt;table&gt; [AS alias] ON &lt;condition&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">list_cos_objects</span></code>(cos_url[, size_unit, …])</p></td>
<td><p>List all objects in the current COS URL.Also, please read the note to see the role of trailing slash in the COS URL..</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.list_results" title="ibmcloudsql.SQLQuery.SQLQuery.list_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list_results</span></code></a>(jobId[, wait])</p></td>
<td><p>NOTE: A single SQL Query can store the queried data in the COS output in multiple objects/partitions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logon</span></code>([force])</p></td>
<td><p>Establish a connection to IBM Cloud.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">order_by_</span></code>(columns)</p></td>
<td><p>ORDER BY &lt;columns&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">partition_by_</span></code>(columns)</p></td>
<td><p>PARTITIONED BY &lt;columns&gt;</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">partition_objects_</span></code>(num_objects)</p></td>
<td><p>PARTITIONED INTO &lt;num&gt;  OBJECTS</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">partition_rows_</span></code>(num_rows)</p></td>
<td><p>PARTITIONED INTO &lt;num&gt; ROWS</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_sql</span></code>()</p></td>
<td><p>print() sql string</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.process_failed_jobs_until_all_completed" title="ibmcloudsql.SQLQuery.SQLQuery.process_failed_jobs_until_all_completed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">process_failed_jobs_until_all_completed</span></code></a>(…)</p></td>
<td><p>re-send those that are failed - due to the time-out mechanism of SQL Query server</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_project_lib_data</span></code>([file_name])</p></td>
<td><p>read the content from the given file (via ProjectLib in IBM Watson Studio’s COS bucket)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">recover_table_partitions</span></code>(table_name)</p></td>
<td><p>Update a partitioned table.This step is required after creating a new partitioned table..</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result" title="ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rename_exact_result</span></code></a>(jobId[, wait])</p></td>
<td><p>A SQL Query can store data into partitioned/paginated multiple objects, or single object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result_joblist" title="ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result_joblist"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rename_exact_result_joblist</span></code></a>(job_list[, wait])</p></td>
<td><p>The bulk mode of <cite>rename_exact_result</cite> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_</span></code>()</p></td>
<td><p>Reset and returns the current sql string</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.run" title="ibmcloudsql.SQLQuery.SQLQuery.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>([pagesize, get_result])</p></td>
<td><p>run the internal SQL statement provided by SQLBuilder using <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.execute_sql" title="ibmcloudsql.SQLQuery.SQLQuery.execute_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute_sql()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.run_sql" title="ibmcloudsql.SQLQuery.SQLQuery.run_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_sql</span></code></a>(sql_text[, pagesize])</p></td>
<td><p>Submits a SQL job, waits for the job to finish (unlike <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.submit_sql" title="ibmcloudsql.SQLQuery.SQLQuery.submit_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit_sql()</span></code></a>) and return the result as Pandas DataFrame.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_</span></code>(columns)</p></td>
<td><p>SELECT &lt;columns&gt;</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.set_tracking_file" title="ibmcloudsql.SQLQuery.SQLQuery.set_tracking_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_tracking_file</span></code></a>(file_name)</p></td>
<td><p>provides the file name which is used for tracking multiple SQL requests</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">show_tables</span></code>([target_cos_url, pattern])</p></td>
<td><p>List the available Hive Metastore.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.sql_ui_link" title="ibmcloudsql.SQLQuery.SQLQuery.sql_ui_link"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sql_ui_link</span></code></a>()</p></td>
<td><p>both print out and also return the string containing SQL Query URL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">store_at_</span></code>(cos_url[, format_type])</p></td>
<td><p>INTO &lt;cos-url&gt; STORED AS &lt;type&gt;</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.submit" title="ibmcloudsql.SQLQuery.SQLQuery.submit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">submit</span></code></a>([pagesize])</p></td>
<td><p>run the internal SQL statement that you created using the APIs provided by SQLBuilder</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.submit_and_track_sql" title="ibmcloudsql.SQLQuery.SQLQuery.submit_and_track_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">submit_and_track_sql</span></code></a>(sql_stmt[, pagesize, …])</p></td>
<td><p>Each SQL Query instance is limited by the number of sql queries that it can handle at a time.This can be a problem when you launch many SQL Query jobs, as such limitation may prevent you to complete all of them in one session.The <cite>max_tries</cite> options when creating the SQL Query client object allows you to re-send the job, which is still limited to one session.The time for one session is often limited when when using SQL Query client via Watson Studio, i.e.you will lose the session after having no interaction with the notebook for a period of time..</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.submit_sql" title="ibmcloudsql.SQLQuery.SQLQuery.submit_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">submit_sql</span></code></a>(sql_stmt[, pagesize, stored_as])</p></td>
<td><p>Asynchronous call - submit and quickly return the job_id.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.wait_for_job" title="ibmcloudsql.SQLQuery.SQLQuery.wait_for_job"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wait_for_job</span></code></a>(jobId[, sleep_time])</p></td>
<td><p>It’s possible that the job’s failed because of Spark’s internal error which does not have any status.So “unknown” is added for such cases..</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">where_</span></code>(condition)</p></td>
<td><p>WHERE &lt;condition&gt; [, &lt;condition&gt;]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">with_</span></code>(table_name, sql_stmt)</p></td>
<td><p>WITH &lt;table&gt; AS &lt;sql&gt; [, &lt;table AS &lt;sql&gt;]</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_project_lib_data</span></code>([file_name])</p></td>
<td><p>write the content to the given file (via ProjectLib in IBM Watson Studio’s COS bucket)</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>export_tags_for_cos_objects</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_session</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.analyze">
<code class="sig-name descname">analyze</code><span class="sig-paren">(</span><em class="sig-param">job_id</em>, <em class="sig-param">print_msg=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.analyze"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.analyze" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides some insights about the data layout from the current SQL statement</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>job_id</strong><span class="classifier">str</span></dt><dd><p>The job ID</p>
</dd>
<dt><strong>print_msg: bool, optional</strong></dt><dd><p>Default is True: print out the hints to the console</p>
</dd>
<dt><strong>.. todo::</strong></dt><dd><ol class="arabic simple">
<li><p>new sql only when max_obj_size &gt; 300MB</p></li>
<li><p>check if STORED AS is used, if not suggested adding to sql with PARQUET or JSON</p></li>
<li><p>add PARITIONED … not at the end, but right after STORED AS (which can be missing in original SQL)</p></li>
</ol>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.configure">
<code class="sig-name descname">configure</code><span class="sig-paren">(</span><em class="sig-param">apikey=None</em>, <em class="sig-param">instance_crn=None</em>, <em class="sig-param">cos_out_url=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.configure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>update the configuration</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.delete_result">
<code class="sig-name descname">delete_result</code><span class="sig-paren">(</span><em class="sig-param">jobId</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.delete_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.delete_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete the COS objects created by a given job-id</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>dataframe</dt><dd><p>A dataframe, with 3 rows, and one field name “Deleted Object”</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The last entry holds the real data, and the last word also indicates the data format</p></li>
<li><p>‘JOBPREFIX NONE’  would avoid having ‘jobid=JOB-ID-NAME’ in the URL</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Delete 3 entries in the output COS</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cos://&lt;cos-name&gt;/bucket_name/jobid=&lt;JOB-ID-NUMBER&gt;/</span>
<span class="go">cos://&lt;cos-name&gt;/bucket_name/jobid=&lt;JOB-ID-NUMBER&gt;/_SUCCESS</span>
<span class="go">cos://&lt;cos-name&gt;/bucket_name/jobid=&lt;JOB-ID-NUMBER&gt;/[parquet|csv|json]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.execute_sql">
<code class="sig-name descname">execute_sql</code><span class="sig-paren">(</span><em class="sig-param">sql_stmt</em>, <em class="sig-param">pagesize=None</em>, <em class="sig-param">get_result=False</em>, <em class="sig-param">stored_as=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.execute_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.execute_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>Extend the behavior of <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.run_sql" title="ibmcloudsql.SQLQuery.SQLQuery.run_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_sql()</span></code></a>.
It is a blocking call that waits for the job to finish (unlike <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.submit_sql" title="ibmcloudsql.SQLQuery.SQLQuery.submit_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit_sql()</span></code></a>), but it has the following features:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>returning of data (Pandas dataframe) is optional (controlled by <cite>get_result</cite> parameter): to help avoiding Python runtime memory overload.</dt><dd><p>This is also useful when you run SQL statements such as DDLs that don’t produce results at all.</p>
</dd>
</dl>
</li>
<li><p>returns a namedtuple, in that result.data is the one returned by <cite>run_sql</cite>, while result.job_id is the one returned by <cite>submit_sql</cite></p></li>
<li><p>raise an exception for a failed job</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sql_stmt: str</strong></dt><dd><p>the SQL statement to run</p>
</dd>
<dt><strong>pagesize: int, optional</strong></dt><dd><p>an integer indicating the number of rows for each partition/page [using PARTITIONED EVERY &lt;pagesize&gt; ROWS syntax]</p>
</dd>
<dt><strong>get_result: bool, optional (default=False)</strong></dt><dd><p>When set it will return only the job_id, but still wait for the job’s completion.
Later, you can get the data using <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_result" title="ibmcloudsql.SQLQuery.SQLQuery.get_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_result()</span></code></a> (job_id, pagenumber)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>namedtuple [<cite>data</cite>, <cite>job_id</cite>]</dt><dd><dl class="simple">
<dt><cite>get_result</cite> = True, then behavior like <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.run_sql" title="ibmcloudsql.SQLQuery.SQLQuery.run_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_sql()</span></code></a> which materializes the returned data as type</dt><dd><p>pd.DataFrame in memory. The default behavior is opposite, to avoid unintended overload of memory.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>KeyError</dt><dd><p>when information about a failed job is missing (job_status, job_id, error, error_message)</p>
</dd>
<dt>SqlQueryFailException</dt><dd><p>when the sql query fails, e.g. time out on the server side</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.export_job_history">
<code class="sig-name descname">export_job_history</code><span class="sig-paren">(</span><em class="sig-param">cos_url=None</em>, <em class="sig-param">export_file_prefix='job_export_'</em>, <em class="sig-param">export_file_suffix='.parquet'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.export_job_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.export_job_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the most recent jobs to COS URL</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cos_url</strong><span class="classifier">str</span></dt><dd><p>A COS URL with prefix, i.e. cos://&lt;cos-name&gt;/&lt;bucket&gt;/&lt;prefix&gt;,
where the data will be stored</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ValueError</dt><dd><p>if COS URL is invalid</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.get_job">
<code class="sig-name descname">get_job</code><span class="sig-paren">(</span><em class="sig-param">jobId</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.get_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.get_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the details of the job-id</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>dict</dt><dd><p>a dict of job details (see keys below)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ValueError</dt><dd><p>when jobId is not correct</p>
</dd>
<dt>HTTPError</dt><dd><p>when RestAPI request fails</p>
</dd>
<dt>JSONDEcodeError</dt><dd><p>when RestAPI returns a non-JSON compliant result</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;job_id&#39;</span><span class="p">,</span>
<span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="p">:</span> <span class="s2">&quot;running&quot;</span><span class="p">,</span> <span class="s2">&quot;failed&quot;</span><span class="p">,</span> <span class="s2">&quot;completed&quot;</span>
<span class="s1">&#39;statement&#39;</span><span class="p">:</span> <span class="s2">&quot;SELECT * ...&quot;</span> <span class="p">[</span><span class="n">the</span> <span class="n">content</span> <span class="n">of</span> <span class="n">SQL</span> <span class="n">Query</span><span class="p">],</span>
<span class="s1">&#39;plan_id&#39;</span> <span class="p">,</span>
<span class="s1">&#39;submit_time&#39;</span><span class="p">,</span>
<span class="s1">&#39;resultset_location&#39;</span><span class="p">,</span>
<span class="s1">&#39;rows_returned&#39;</span><span class="p">,</span>
<span class="s1">&#39;rows_read&#39;</span> <span class="p">,</span>
<span class="s1">&#39;bytes_read&#39;</span> <span class="p">,</span>
<span class="s1">&#39;resultset_format&#39;</span><span class="p">:</span> <span class="s1">&#39;csv&#39;</span><span class="p">,</span>
<span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-03-06T21:58:26.274Z&#39;</span><span class="p">,</span>
<span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="s1">&#39;username@us.ibm.com&#39;</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;bytes_read&quot;</span><span class="p">:</span> <span class="mi">43058</span><span class="p">,</span>
    <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-08T03:20:39.131Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ab3f7567-280b-40c9-87a9-256b846f89db&quot;</span><span class="p">,</span>
    <span class="s2">&quot;plan_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ead0f7f5-0c96-40c0-9aae-63c4846d8188&quot;</span><span class="p">,</span>
    <span class="s2">&quot;resultset_format&quot;</span><span class="p">:</span> <span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
    <span class="s2">&quot;resultset_location&quot;</span><span class="p">:</span> <span class="s2">&quot;cos://s3.us-south.cloud-object-storage.appdomain.cloud/tuan-sql-result/customer_orders/jobid=ab3f7567-280b-40c9-87a9-256b846f89db&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rows_read&quot;</span><span class="p">:</span> <span class="mi">921</span><span class="p">,</span>
    <span class="s2">&quot;rows_returned&quot;</span><span class="p">:</span> <span class="mi">830</span><span class="p">,</span>
    <span class="s2">&quot;statement&quot;</span><span class="p">:</span> <span class="s2">&quot;SELECT OrderID, c.CustomerID CustomerID, CompanyName, ContactName, ContactTitle, Address, City, Region, PostalCode, Country, Phone, Fax          EmployeeID, OrderDate, RequiredDate, ShippedDate, ShipVia, Freight, ShipName, ShipAddress,          ShipCity, ShipRegion, ShipPostalCode, ShipCountry FROM cos://us-geo/sql/orders.parquet STORED AS PARQUET o,          cos://us-geo/sql/customers.parquet STORED AS PARQUET c          WHERE c.CustomerID = o.CustomerID          INTO cos://us-south/tuan-sql-result/customer_orders STORED AS PARQUET PARTITIONED BY (ShipCountry, ShipCity)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;completed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;submit_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-08T03:20:00.617Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;tmhoangt@us.ibm.com&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.get_jobs">
<code class="sig-name descname">get_jobs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.get_jobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.get_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the up-to-30 most recent jobs from the given Cloud API</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>dataframe</dt><dd><p>a pd.DataFrame with fields - total 30 rows, corresponding to the 30 most recent jobs</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>get_jobs() is used by <a href="#system-message-1"><span class="problematic" id="problematic-1">`</span></a>export_job_history`(cos_out_url) which is used to save such data</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">job_id</span>
<span class="go">status: &quot;running&quot;, &quot;failed&quot;, &quot;completed&quot;</span>
<span class="go">user_id</span>
<span class="go">statement</span>
<span class="go">resultset_location</span>
<span class="go">submit_time</span>
<span class="go">end_time</span>
<span class="go">rows_read</span>
<span class="go">rows_returned</span>
<span class="go">bytes_read</span>
<span class="go">error</span>
<span class="go">error_message</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">job_id      status  user_id statement       resultset_location      submit_time     end_time         ...</span>
<span class="go">&lt;long-string&gt; completed     &lt;email-here&gt;    &lt;query-string&gt;  &lt;cos-url-result-location&gt; 2020-02-21T16:19:03.638Z      2020-02-21T16:19:13.691Z</span>

<span class="go">rows_read   rows_returned   bytes_read      error   error_message</span>
<span class="go">1760        29      41499   None    None</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.get_jobs_count_with_status">
<code class="sig-name descname">get_jobs_count_with_status</code><span class="sig-paren">(</span><em class="sig-param">status</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.get_jobs_count_with_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.get_jobs_count_with_status" title="Permalink to this definition">¶</a></dt>
<dd><p>return the number of jobs in the SQL Query server for the given <cite>status</cite></p>
<p>It has the limitation as described in <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_jobs" title="ibmcloudsql.SQLQuery.SQLQuery.get_jobs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_jobs()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.get_jobs_with_status">
<code class="sig-name descname">get_jobs_with_status</code><span class="sig-paren">(</span><em class="sig-param">job_id_list</em>, <em class="sig-param">status</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.get_jobs_with_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.get_jobs_with_status" title="Permalink to this definition">¶</a></dt>
<dd><p>return the list of job_id, among those provided, that have the given status</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>job_id_list: list</strong></dt><dd><p>List of job_id to check</p>
</dd>
<dt><strong>status</strong><span class="classifier">str</span></dt><dd><p>“completed”, “running”, or “failed”</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>list:</dt><dd><p>List of job ids</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.get_number_running_jobs">
<code class="sig-name descname">get_number_running_jobs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.get_number_running_jobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.get_number_running_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>return the number of running jobs in the SQL Query server</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.get_result">
<code class="sig-name descname">get_result</code><span class="sig-paren">(</span><em class="sig-param">jobId</em>, <em class="sig-param">pagenumber=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.get_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.get_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the queried data from the given job-id</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>jobId: int</strong></dt><dd><p>The value, if not stored, can be retrieved from <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_jobs" title="ibmcloudsql.SQLQuery.SQLQuery.get_jobs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_jobs()</span></code></a></p>
</dd>
<dt><strong>pagenumber: int, optional</strong></dt><dd><p>If the data, from the given <cite>job_id</cite> is saved in pages/partitions, then this should be a value
in the range from 1 to len(self.list_results(job_id))</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dataframe</dt><dd><p>The dataframe holding the queried data from a completed job</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl -XGET \</span>
<span class="go">    --url &quot;https://api.sql-query.cloud.ibm.com/v2/sql_jobs?instance_crn=&lt;YOUR_SQL_QUERY_CRN&gt;&quot; \</span>
<span class="go">    -H &quot;Accept: application/json&quot; \</span>
<span class="go">    -H &quot;Authorization: Bearer &lt;YOUR_BEARER_TOKEN&gt;&quot;  \</span>
<span class="go">    -H &quot;Content-Type: application/json&quot;</span>

<span class="go">&quot;&quot;&quot;</span>
<span class="go">{</span>
<span class="go">&quot;jobs&quot;: [</span>
<span class="go">    {</span>
<span class="go">    &quot;job_id&quot;: &quot;7ebed7f7-00dc-44a2-acfa-5bdb53889648&quot;,</span>
<span class="go">    &quot;status&quot;: &quot;completed&quot;,</span>
<span class="go">    &quot;submit_time&quot;: &quot;2018-08-14T08:45:54.012Z&quot;,</span>
<span class="go">    &quot;user_id&quot;: &quot;user1@ibm.com&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">    &quot;job_id&quot;: &quot;ffde4c5a-1cc2-448b-b377-43573818e5d8&quot;,</span>
<span class="go">    &quot;status&quot;: &quot;completed&quot;,</span>
<span class="go">    &quot;submit_time&quot;: &quot;2018-08-14T08:47:33.350Z&quot;,</span>
<span class="go">    &quot;user_id&quot;: &quot;user1@ibm.com&quot;</span>
<span class="go">    }</span>
<span class="go">]</span>
<span class="go">}</span>
<span class="go">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s2">&quot;https://api.sql-query.cloud.ibm.com/v2/sql_jobs/</span><span class="si">{}</span><span class="s2">?instance_crn=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jobId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance_crn</span><span class="p">),</span>
    <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">request_headers</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">or</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">201</span><span class="p">:</span>
    <span class="n">status_response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cloud</span><span class="o">.</span><span class="n">ibm</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">apidocs</span><span class="o">/</span><span class="n">sql</span><span class="o">-</span><span class="n">query</span><span class="c1">#run-an-sql-job</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.get_schema_data">
<code class="sig-name descname">get_schema_data</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em>, <em class="sig-param">typ='json'</em>, <em class="sig-param">dry_run=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.get_schema_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.get_schema_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the schema of COS URL</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cos_url</strong><span class="classifier">str</span></dt><dd><p>The COS URL where data is stored</p>
</dd>
<dt><strong>typ</strong><span class="classifier">str, optional</span></dt><dd><p>The format type of the data, default is ‘json’
Use from [‘json’, ‘csv’, ‘parquet’] with case-insensitive</p>
</dd>
<dt><strong>dry_run: bool, optional</strong></dt><dd><p>This option, once selected as True, returns the internally generated SQL statement, and no job is queried.</p>
</dd>
<dt><strong>result_format: string</strong></dt><dd><p>‘dataframe’
‘list’</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>DataFrame</dt><dd><p>3 columns: name (object), nullable (bool), type (object)</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>in either scenarios: (1) target COS URL is not set, (2) invalid type, (3) invalid COS URL</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.is_a_supported_storage_type">
<code class="sig-name descname">is_a_supported_storage_type</code><span class="sig-paren">(</span><em class="sig-param">typ</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.is_a_supported_storage_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.is_a_supported_storage_type" title="Permalink to this definition">¶</a></dt>
<dd><p>check if a type is in a supported format</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.list_results">
<code class="sig-name descname">list_results</code><span class="sig-paren">(</span><em class="sig-param">jobId</em>, <em class="sig-param">wait=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.list_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.list_results" title="Permalink to this definition">¶</a></dt>
<dd><p>NOTE: A single SQL Query can store the queried data in the COS output
in multiple objects/partitions</p>
<p>When one of those below is used</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[ PARTITIONED BY,</span>
<span class="go">PARTITIONED EVERY x ROWS      [implicitly used with pagesize=X option]</span>
<span class="go">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>job_id: str</strong></dt><dd><p>The Job ID</p>
</dd>
<dt><strong>wait: bool, default:False</strong></dt><dd><p>If True, wait for the requested <cite>job_id</cite> to complete to get the information</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None (or nothing) if the function fails</dt><dd><p>DataFrame (4 fields: ObjectURL, Size, Bucket, Object) - each row correspond to the information of one partition</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>To know the number of partitions being used, use ‘len(self.list_results(job_id))’</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.my_jobs">
<em class="property">property </em><code class="sig-name descname">my_jobs</code><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.my_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return information about jobs already queried via <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_job" title="ibmcloudsql.SQLQuery.SQLQuery.get_job"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_job()</span></code></a>
issued by this SQLClient class object</p>
<p>This is different from <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_jobs" title="ibmcloudsql.SQLQuery.SQLQuery.get_jobs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_jobs()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>dict</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.process_failed_jobs_until_all_completed">
<code class="sig-name descname">process_failed_jobs_until_all_completed</code><span class="sig-paren">(</span><em class="sig-param">job_id_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.process_failed_jobs_until_all_completed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.process_failed_jobs_until_all_completed" title="Permalink to this definition">¶</a></dt>
<dd><p>re-send those that are failed - due to the time-out mechanism of SQL Query server</p>
<p>Here, if job_time &lt; 40 minutes, then we re-send.</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result">
<code class="sig-name descname">rename_exact_result</code><span class="sig-paren">(</span><em class="sig-param">jobId</em>, <em class="sig-param">wait=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.rename_exact_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result" title="Permalink to this definition">¶</a></dt>
<dd><p>A SQL Query can store data into partitioned/paginated multiple objects, or single object.</p>
<p>Even with single object, indeed, multiple objects are created, two of them has size 0.
(&lt;URL&gt;/_SUCCESS, and &lt;URL&gt;/) beside the ones that hold data (&lt;URL&gt;/&lt;data1&gt;, &lt;URL&gt;/&lt;data2&gt;)</p>
<p>This API deletes the two 0-size objects, and keep only the ones that hold data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>job_id</strong><span class="classifier">str</span></dt><dd><p>A string representation of job_id</p>
</dd>
<dt><strong>wait: bool, optional</strong></dt><dd><p>The given <cite>job_id</cite> may not be completed yet, so you have the option to wait for it to completed first.</p>
<p>Default is False</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If the job_id is the job in that the result is “PARTITIONED BY” or “pagesize=” or “PARITIONED EVERY x ROWS” is used
or the rename_exact_result() has been applied to this job_id.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result_joblist">
<code class="sig-name descname">rename_exact_result_joblist</code><span class="sig-paren">(</span><em class="sig-param">job_list</em>, <em class="sig-param">wait=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.rename_exact_result_joblist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result_joblist" title="Permalink to this definition">¶</a></dt>
<dd><p>The bulk mode of <cite>rename_exact_result</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>job_list: list</strong></dt><dd><p>A list of job_id</p>
</dd>
<dt><strong>wait: bool, optional</strong></dt><dd><p>The same meaning as the one used in <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result" title="ibmcloudsql.SQLQuery.SQLQuery.rename_exact_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rename_exact_result()</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">pagesize=None</em>, <em class="sig-param">get_result=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.run" title="Permalink to this definition">¶</a></dt>
<dd><p>run the internal SQL statement provided by SQLBuilder using <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.execute_sql" title="ibmcloudsql.SQLQuery.SQLQuery.execute_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute_sql()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.run_sql">
<code class="sig-name descname">run_sql</code><span class="sig-paren">(</span><em class="sig-param">sql_text</em>, <em class="sig-param">pagesize=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.run_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.run_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>Submits a SQL job, waits for the job to finish (unlike <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.submit_sql" title="ibmcloudsql.SQLQuery.SQLQuery.submit_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit_sql()</span></code></a>) and return the result as Pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sql_text: str</strong></dt><dd><p>the SQL statement to run</p>
</dd>
<dt><strong>pagesize: int, optional</strong></dt><dd><p>an integer indicating the number of rows for each partition/page [using PARTITIONED EVERY &lt;pagesize&gt; ROWS syntax]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.DataFrame with the query results.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>CosUrlNotFoundException</dt><dd><p>the COS URL is not valid</p>
</dd>
<dt>CosUrlInaccessibleException</dt><dd><p>the COS URL is inaccessible - no access granted to the given API key</p>
</dd>
<dt>SqlQueryInvalidFormatException</dt><dd><p>the format provided to COS URL is incorrect</p>
</dd>
<dt>KeyError</dt><dd><p>the returned error message does not have job_id, error, or error_message</p>
</dd>
<dt>Exception</dt><dd><p>unexpected exception</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.set_tracking_file">
<code class="sig-name descname">set_tracking_file</code><span class="sig-paren">(</span><em class="sig-param">file_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.set_tracking_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.set_tracking_file" title="Permalink to this definition">¶</a></dt>
<dd><p>provides the file name which is used for tracking multiple SQL requests</p>
<p class="rubric">Notes</p>
<p>This is the local file, which is used when you don’t have access to Watson Studio</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.sql_ui_link">
<code class="sig-name descname">sql_ui_link</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.sql_ui_link"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.sql_ui_link" title="Permalink to this definition">¶</a></dt>
<dd><p>both print out and also return the string containing SQL Query URL</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.submit">
<code class="sig-name descname">submit</code><span class="sig-paren">(</span><em class="sig-param">pagesize=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.submit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>run the internal SQL statement that you created using the APIs provided by SQLBuilder</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.submit_and_track_sql">
<code class="sig-name descname">submit_and_track_sql</code><span class="sig-paren">(</span><em class="sig-param">sql_stmt</em>, <em class="sig-param">pagesize=None</em>, <em class="sig-param">file_name=None</em>, <em class="sig-param">force_rerun=False</em>, <em class="sig-param">stored_as=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.submit_and_track_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.submit_and_track_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>Each SQL Query instance is limited by the number of sql queries that it
can handle at a time.  This can be a problem when you
launch many SQL Query jobs, as such limitation may prevent you to
complete all of them in one session. The <cite>max_tries</cite> options when creating
the SQL Query client object allows
you to re-send the job, which is still limited to one session.
The time for one session is often limited when when using
SQL Query client via Watson Studio, i.e. you
will lose the session after having no interaction with the notebook for
a period of time.</p>
<p>This API provides the capability to put the information of each
launched jobs in a <cite>file_name</cite> stored either</p>
<ul class="simple">
<li><p>as an asset in the Watson Studio’s Project.</p></li>
<li><p>as a regular file in the local machine.</p></li>
</ul>
<p>The SQL Query client will check the content of such file name to see
if the given <cite>sql_stmt</cite> has been
launched, and if so, whether it is completed or not. If not
completed, then it relaunches the job, and update the content in this
file. Otherwise, it skips the <cite>sql_stmt</cite>.</p>
<p>To check if a <cite>sql_stmt</cite> has been issued or not, the
<a class="reference internal" href="#ibmcloudsql.sql_magic.format_sql" title="ibmcloudsql.sql_magic.format_sql"><code class="xref py py-func docutils literal notranslate"><span class="pre">format_sql()</span></code></a> transforms the query string into a style that can
be used for string comparison that is tolerance to white spaces, new
lines, comments, lower-case or upper-case uses in the query string.
This is done by the decorator <a class="reference internal" href="#ibmcloudsql.SQLQuery.check_saved_jobs_decorator" title="ibmcloudsql.SQLQuery.check_saved_jobs_decorator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">check_saved_jobs_decorator()</span></code></a>.</p>
<p>This is beneficial in the scenario when you launch many many jobs, and don’t want to restart from the beginning.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>sql_stmt: str</strong></dt><dd><p>sql string</p>
</dd>
<dt><strong>pagesize: int, optional</strong></dt><dd><p>the page size</p>
</dd>
<dt><strong>file_name: str, optional</strong></dt><dd><p>The file name should be a JSON file, i.e. $file_name.json.
You need to provide the file name if</p>
<ul class="simple">
<li><ol class="arabic simple">
<li><p>you use Watson studio notebook and you haven’t provided it in <a class="reference internal" href="#ibmcloudsql.cos.COSClient.connect_project_lib" title="ibmcloudsql.cos.COSClient.connect_project_lib"><code class="xref py py-meth docutils literal notranslate"><span class="pre">connect_project_lib()</span></code></a>,</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>you use local notebook, and you want to use a local file to track it</p></li>
</ol>
</li>
</ul>
<p>You don’t need to provide the file name if you’re using Watson studio, and the file name has been provided via <a class="reference internal" href="#ibmcloudsql.cos.COSClient.connect_project_lib" title="ibmcloudsql.cos.COSClient.connect_project_lib"><code class="xref py py-meth docutils literal notranslate"><span class="pre">connect_project_lib()</span></code></a>.</p>
</dd>
<dt><strong>force_rerun: bool</strong></dt><dd><p>Rerun even if the given sql statement has been previously launched and completed. Be cautious when enabling this flag, as
you may have duplicated number of data onto the same location. The reason for this flag is to provide the option to rerun a command
- in that the previously created data has been deleted.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>To use this API in Watson Studio, the SQL Query client must already connected to the ProjectLib object via <a class="reference internal" href="#ibmcloudsql.cos.COSClient.connect_project_lib" title="ibmcloudsql.cos.COSClient.connect_project_lib"><code class="xref py py-meth docutils literal notranslate"><span class="pre">connect_project_lib()</span></code></a> method.</p>
<p>This APIs make use of <a class="reference internal" href="#ibmcloudsql.cos.COSClient.connect_project_lib" title="ibmcloudsql.cos.COSClient.connect_project_lib"><code class="xref py py-meth docutils literal notranslate"><span class="pre">COSClient.connect_project_lib()</span></code></a>, <a class="reference internal" href="#ibmcloudsql.cos.COSClient.read_project_lib_data" title="ibmcloudsql.cos.COSClient.read_project_lib_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">COSClient.read_project_lib_data()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.submit_sql">
<code class="sig-name descname">submit_sql</code><span class="sig-paren">(</span><em class="sig-param">sql_stmt</em>, <em class="sig-param">pagesize=None</em>, <em class="sig-param">stored_as=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.submit_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.submit_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronous call - submit and quickly return the job_id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sql_stmt: str</strong></dt><dd><p>SQL Query string</p>
</dd>
<dt><strong>pagesize: int, optional</strong></dt><dd><p>an integer indicating the number of rows for each partition/page
[using PARTITIONED EVERY &lt;pagesize&gt; ROWS syntax]</p>
</dd>
<dt><strong>stored_as: string</strong></dt><dd><p>The type being used, only if ‘INTO … STORED AS …’ is not provided</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>job_id</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>RateLimitedException</dt><dd><p>when the SQLQUery instance is serving the max-limit of requests</p>
</dd>
<dt>SyntaxError</dt><dd><p>for both KeyError or HTTPError</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl -XPOST                 --url &quot;https://api.sql-query.cloud.ibm.com/v2/sql_jobs?instance_crn=YOUR_SQL_QUERY_CRN&quot;                 -H &quot;Accept: application/json&quot;                 -H &quot;Authorization: Bearer YOUR_BEARER_TOKEN&quot;                 -H &quot;Content-Type: application/json&quot;                 -d &#39;{&quot;statement&quot;:&quot;SELECT firstname FROM cos://us-geo/sql/employees.parquet STORED AS PARQUET WHERE EMPLOYEEID=5 INTO cos://us-geo/target-bucket/q1-results&quot; }&#39;</span>
</pre></div>
</div>
<p>NOTE:</p>
<p>1. All the headers (-H) can be put into a dictionary and
passed to the <em>headers</em> argument of requests.post() API.</p>
<p>2. All the data (-d option) is put into a dictionary and
passed to the <em>json</em> argument of requests.post() API.</p>
<blockquote>
<div><ul class="simple">
<li><p>‘statement’: value is full SQL statement in string</p></li>
<li><p>‘resultset_target’ (optional): only need when there is no ‘INTO statement’ in the query string, and the value must be the COS URL output</p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sqlData</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;statement&#39;</span><span class="p">:</span> <span class="n">sql_stmt</span><span class="p">}</span>
<span class="n">request_headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">}</span>
<span class="n">request_headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;Accept&#39;</span><span class="p">:</span><span class="s1">&#39;application/json&#39;</span><span class="p">})</span>
<span class="n">request_headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="p">})</span>
<span class="n">request_headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;authorization&#39;</span><span class="p">:</span> <span class="s1">&#39;Bearer </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ro_credentials</span><span class="o">.</span><span class="n">token</span><span class="p">)})</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="s2">&quot;https://api.sql-query.cloud.ibm.com/v2/sql_jobs?instance_crn=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance_crn</span><span class="p">),</span>
    <span class="n">headers</span><span class="o">=</span><span class="n">request_headers</span><span class="p">,</span>
    <span class="n">json</span><span class="o">=</span><span class="n">sqlData</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">{</span>
<span class="sd">    &quot;errors&quot;: [</span>
<span class="sd">        {</span>
<span class="sd">        &quot;code&quot;: &quot;bad_request&quot;,</span>
<span class="sd">        &quot;message&quot;: &quot;Target url specified in parameter resultset_target and as part of into clause in statement&quot;</span>
<span class="sd">        }</span>
<span class="sd">    ]</span>
<span class="sd">}</span>
<span class="sd">{</span>
<span class="sd">    &quot;job_id&quot;: &quot;e2adca0a-9247-4cfa-ac58-db4b2bc33a01&quot;,</span>
<span class="sd">    &quot;status&quot;: &quot;queued&quot;</span>
<span class="sd">}</span>
<span class="sd">{</span>
<span class="sd">    &quot;status_code&quot;: 429,</span>
<span class="sd">    &quot;errors&quot;: [</span>
<span class="sd">        {</span>
<span class="sd">        &quot;code&quot;: &quot;too_many_requests&quot;,</span>
<span class="sd">        &quot;message&quot;: &quot;This instance is currently running its maximum number of query jobs. Try again later, after at least one of the currently running jobs has completed.&quot;</span>
<span class="sd">        }</span>
<span class="sd">    ]</span>
<span class="sd">}</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># error code information: https://cloud.ibm.com/apidocs/sql-query</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.SQLQuery.SQLQuery.wait_for_job">
<code class="sig-name descname">wait_for_job</code><span class="sig-paren">(</span><em class="sig-param">jobId</em>, <em class="sig-param">sleep_time=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#SQLQuery.wait_for_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.SQLQuery.wait_for_job" title="Permalink to this definition">¶</a></dt>
<dd><p>It’s possible that the job’s failed because of Spark’s internal error
which does not have any status. So “unknown” is added for such cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>jobId: str</strong></dt><dd><p>The job-id</p>
</dd>
<dt><strong>sleep_time: int, optional</strong></dt><dd><p>The time interval to sleep before making a new check if the job is done</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>‘failed’, ‘completed’, or ‘unknown’</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibmcloudsql.SQLQuery.check_saved_jobs_decorator">
<code class="sig-prename descclassname">ibmcloudsql.SQLQuery.</code><code class="sig-name descname">check_saved_jobs_decorator</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#check_saved_jobs_decorator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.check_saved_jobs_decorator" title="Permalink to this definition">¶</a></dt>
<dd><p>a decorator that load data from ProjectLib, check for completed SQL
Query job, before deciding to launch it</p>
</dd></dl>

<dl class="function">
<dt id="ibmcloudsql.SQLQuery.save">
<code class="sig-prename descclassname">ibmcloudsql.SQLQuery.</code><code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param">file_name</em>, <em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save file still ok in the case of Ctrl-C is pressed</p>
</dd></dl>

<dl class="function">
<dt id="ibmcloudsql.SQLQuery.validate_job_status">
<code class="sig-prename descclassname">ibmcloudsql.SQLQuery.</code><code class="sig-name descname">validate_job_status</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/SQLQuery.html#validate_job_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.SQLQuery.validate_job_status" title="Permalink to this definition">¶</a></dt>
<dd><p>check if input about job status, via <cite>status</cite> argument is corrected</p>
</dd></dl>

</section>
<section id="module-ibmcloudsql.catalog_table">
<span id="catalog-table-module"></span><h2>Catalog/Table module<a class="headerlink" href="#module-ibmcloudsql.catalog_table" title="Permalink to this headline">¶</a></h2>
<p>Catalog Table.</p>
<dl class="class">
<dt id="ibmcloudsql.catalog_table.HiveMetastore">
<em class="property">class </em><code class="sig-prename descclassname">ibmcloudsql.catalog_table.</code><code class="sig-name descname">HiveMetastore</code><span class="sig-paren">(</span><em class="sig-param">target_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class supports the handling HIVE catalog table.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.target_url" title="ibmcloudsql.catalog_table.HiveMetastore.target_url"><code class="xref py py-obj docutils literal notranslate"><span class="pre">target_url</span></code></a></dt><dd><p>Return the target COS URL.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.add_partitions" title="ibmcloudsql.catalog_table.HiveMetastore.add_partitions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_partitions</span></code></a>(table_name, col_names)</p></td>
<td><p>Update the table with a partition column having new value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.configure" title="ibmcloudsql.catalog_table.HiveMetastore.configure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">configure</span></code></a>(target_url)</p></td>
<td><p>Update the configuration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.create_metaindex" title="ibmcloudsql.catalog_table.HiveMetastore.create_metaindex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_metaindex</span></code></a>(table_name)</p></td>
<td><p>Create a metaindex for a given table.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.create_partitioned_table" title="ibmcloudsql.catalog_table.HiveMetastore.create_partitioned_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_partitioned_table</span></code></a>(table_name[, …])</p></td>
<td><p>Create a partitioned table for data on COS.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.create_table" title="ibmcloudsql.catalog_table.HiveMetastore.create_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_table</span></code></a>(table_name[, cos_url, …])</p></td>
<td><p>Create a table for data on COS.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.describe_table" title="ibmcloudsql.catalog_table.HiveMetastore.describe_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">describe_table</span></code></a>(table_name)</p></td>
<td><p>Return the schema of a table.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.drop_all_tables" title="ibmcloudsql.catalog_table.HiveMetastore.drop_all_tables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_all_tables</span></code></a>()</p></td>
<td><p>Delete all created tables in the project.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.drop_table" title="ibmcloudsql.catalog_table.HiveMetastore.drop_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_table</span></code></a>([table_name])</p></td>
<td><p>Drop a given table.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.drop_tables" title="ibmcloudsql.catalog_table.HiveMetastore.drop_tables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_tables</span></code></a>(table_names)</p></td>
<td><p>Drop a list of tables.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.get_metaindex" title="ibmcloudsql.catalog_table.HiveMetastore.get_metaindex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metaindex</span></code></a>(table_name)</p></td>
<td><p>Get the metaindex of a table.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.get_schema_table" title="ibmcloudsql.catalog_table.HiveMetastore.get_schema_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_schema_table</span></code></a>(table_name)</p></td>
<td><p>Return the schema of table.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.recover_table_partitions" title="ibmcloudsql.catalog_table.HiveMetastore.recover_table_partitions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recover_table_partitions</span></code></a>(table_name)</p></td>
<td><p>Update a partitioned table.This step is required after creating a new partitioned table..</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.catalog_table.HiveMetastore.show_tables" title="ibmcloudsql.catalog_table.HiveMetastore.show_tables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">show_tables</span></code></a>([target_cos_url, pattern])</p></td>
<td><p>List the available Hive Metastore.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.add_partitions">
<code class="sig-name descname">add_partitions</code><span class="sig-paren">(</span><em class="sig-param">table_name</em>, <em class="sig-param">col_names</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.add_partitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.add_partitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the table with a partition column having new value.</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.configure">
<code class="sig-name descname">configure</code><span class="sig-paren">(</span><em class="sig-param">target_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.configure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the configuration.</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.create_metaindex">
<code class="sig-name descname">create_metaindex</code><span class="sig-paren">(</span><em class="sig-param">table_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.create_metaindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.create_metaindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a metaindex for a given table.</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.create_partitioned_table">
<code class="sig-name descname">create_partitioned_table</code><span class="sig-paren">(</span><em class="sig-param">table_name</em>, <em class="sig-param">cos_url=None</em>, <em class="sig-param">format_type='CSV'</em>, <em class="sig-param">force_recreate=False</em>, <em class="sig-param">schema=None</em>, <em class="sig-param">partition_list=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.create_partitioned_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.create_partitioned_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a partitioned table for data on COS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>table_name: str</strong></dt><dd><p>the name of the table to be created</p>
</dd>
<dt><strong>cos_url</strong><span class="classifier">str, optional</span></dt><dd><p>The COS URL from which the table should reference to
If not provided, it uses the internal <cite>self.cos_in_url</cite></p>
</dd>
<dt><strong>format_type: string, optional</strong></dt><dd><p>The type of the data above (default: CSV)</p>
</dd>
<dt><strong>force_recreate: bool</strong></dt><dd><p>(True) force to recreate an existing table</p>
</dd>
<dt><strong>schema: None or string</strong></dt><dd><p>If None, then automatic schema detection is used. Otherwise,
pass in the comma-separated
string in the form “(columnName type, columnName type)”</p>
</dd>
<dt><strong>partition_list: comma-separated string | list</strong></dt><dd><p>the list of columns to be part of the partitioning. NOTE: the order
matters.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError:</dt><dd><p>when the argument is invalid for <cite>cos_url</cite>
(invalid format or there is no such location),
format_type (invalid value)</p>
</dd>
<dt>SqlQueryFailException:</dt><dd><p>when it cannot remove the given table name</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.create_table">
<code class="sig-name descname">create_table</code><span class="sig-paren">(</span><em class="sig-param">table_name</em>, <em class="sig-param">cos_url=None</em>, <em class="sig-param">format_type='CSV'</em>, <em class="sig-param">force_recreate=False</em>, <em class="sig-param">blocking=True</em>, <em class="sig-param">schema=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.create_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.create_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a table for data on COS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>table_name: str</strong></dt><dd><p>The name of the table</p>
</dd>
<dt><strong>cos_url</strong><span class="classifier">str, optional</span></dt><dd><p>The COS URL from which the table should reference to
If not provided, it uses the internal <cite>self.cos_in_url</cite></p>
</dd>
<dt><strong>format_type: string, optional</strong></dt><dd><p>The type of the data above that you want to reference (default: CSV)</p>
</dd>
<dt><strong>force_recreate: bool, optional</strong></dt><dd><p>(True) force to recreate an existing table</p>
</dd>
<dt><strong>blocking: bool, optional</strong></dt><dd><p>(True) wait until it returns the resut</p>
</dd>
<dt><strong>schema: None or string</strong></dt><dd><p>If None, then automatic schema detection is used. Otherwise, pass in the comma-separated
string in the form “(columnName type, columnName type)”</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>none if job “failed”</dt><dd><p>otherwise returns</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError:</dt><dd><p>when the argument is invalid for <cite>cos_url</cite> (invalid format or there is no such location),
format_type (invalid value)</p>
</dd>
<dt>SqlQueryDropTableException</dt><dd><p>when it cannot remove the given table name</p>
</dd>
<dt>SqlQueryCreateTableException</dt><dd><p>when it cannot create the given table name</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.describe_table">
<code class="sig-name descname">describe_table</code><span class="sig-paren">(</span><em class="sig-param">table_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.describe_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.describe_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the schema of a table.</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.drop_all_tables">
<code class="sig-name descname">drop_all_tables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.drop_all_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.drop_all_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete all created tables in the project.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>bool</dt><dd><p>True [if success]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.drop_table">
<code class="sig-name descname">drop_table</code><span class="sig-paren">(</span><em class="sig-param">table_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.drop_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.drop_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop a given table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>table_name: str, optional</strong></dt><dd><p>The name of the table
If skipped, the being tracked catalog-table is used</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str:</dt><dd><p>a job status</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>SqlQueryDropTableException</dt><dd><p>when it cannot remove the given table name</p>
</dd>
<dt>ValueError</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.drop_tables">
<code class="sig-name descname">drop_tables</code><span class="sig-paren">(</span><em class="sig-param">table_names</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.drop_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.drop_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop a list of tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>table_names: list</strong></dt><dd><p>A list of tables</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.get_metaindex">
<code class="sig-name descname">get_metaindex</code><span class="sig-paren">(</span><em class="sig-param">table_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.get_metaindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.get_metaindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the metaindex of a table.</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.get_schema_table">
<code class="sig-name descname">get_schema_table</code><span class="sig-paren">(</span><em class="sig-param">table_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.get_schema_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.get_schema_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the schema of table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>table_name: str</strong></dt><dd><p>Name of the HIVE catalog table</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——</strong></dt><dd></dd>
<dt><strong>DataFrame or None [if failed - table not found]</strong></dt><dd><p>3 columns: col_name (object), data_type (object), comment (float64)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.recover_table_partitions">
<code class="sig-name descname">recover_table_partitions</code><span class="sig-paren">(</span><em class="sig-param">table_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.recover_table_partitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.recover_table_partitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a partitioned table. This step is required after creating a new partitioned table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>table_name: str</strong></dt><dd><p>The partitioned table name</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.show_tables">
<code class="sig-name descname">show_tables</code><span class="sig-paren">(</span><em class="sig-param">target_cos_url=None</em>, <em class="sig-param">pattern=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/catalog_table.html#HiveMetastore.show_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.show_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>List the available Hive Metastore.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_cos_url: string, optional</strong></dt><dd><p>The COR URL where the information about the tables are stored</p>
</dd>
<dt><strong>pattern: str, optional</strong></dt><dd><p>If provided, this should be a pattern being used in name matching,
e.g. ‘<em>cus</em>’, which finds all tables with the name has ‘cus’</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>DataFrame or None</dt><dd><p>return <cite>None</cite> if there is an error.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>SqlQueryFailException</dt><dd></dd>
<dt>ValueError</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.catalog_table.HiveMetastore.target_url">
<em class="property">property </em><code class="sig-name descname">target_url</code><a class="headerlink" href="#ibmcloudsql.catalog_table.HiveMetastore.target_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the target COS URL.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ibmcloudsql.cos">
<span id="cloud-object-storage-module"></span><h2>Cloud Object Storage module<a class="headerlink" href="#module-ibmcloudsql.cos" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibmcloudsql.cos.COSClient">
<em class="property">class </em><code class="sig-prename descclassname">ibmcloudsql.cos.</code><code class="sig-name descname">COSClient</code><span class="sig-paren">(</span><em class="sig-param">cloud_apikey=''</em>, <em class="sig-param">cos_url=''</em>, <em class="sig-param">client_info='COS Client'</em>, <em class="sig-param">staging=False</em>, <em class="sig-param">thread_safe=False</em>, <em class="sig-param">iam_max_tries=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ibmcloudsql.cos.ParsedUrl" title="ibmcloudsql.cos.ParsedUrl"><code class="xref py py-class docutils literal notranslate"><span class="pre">ibmcloudsql.cos.ParsedUrl</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">utilities.IBMCloudAccess</span></code></p>
<p>This class handles the interaction with IBM COS storage</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>cloud_apikey</strong><span class="classifier">str, optional</span></dt><dd><p>an account-level API key [manage/Access (IAM)/IBM Cloud API keys]</p>
<p><a class="reference external" href="https://cloud.ibm.com/docs/iam/users_roles.html">https://cloud.ibm.com/docs/iam/users_roles.html</a>
<a class="reference external" href="https://cloud.ibm.com/docs/services/cloud-object-storage?topic=cloud-object-storage-getting-started">https://cloud.ibm.com/docs/services/cloud-object-storage?topic=cloud-object-storage-getting-started</a></p>
</dd>
<dt><strong>cos_url</strong><span class="classifier">str, optional</span></dt><dd><p>the COS URL where retrieved data is stored</p>
</dd>
<dt><strong>client_info</strong><span class="classifier">str, optional</span></dt><dd><p>User-defined string</p>
</dd>
<dt><strong>thread_safe: bool, optional (=False)</strong></dt><dd><p>If thread-safe is used, a new Session object is created upon this object creation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">cos_session</span></code></dt><dd><p>Get the current COS session.</p>
</dd>
<dt><a class="reference internal" href="#ibmcloudsql.cos.COSClient.project_lib" title="ibmcloudsql.cos.COSClient.project_lib"><code class="xref py py-obj docutils literal notranslate"><span class="pre">project_lib</span></code></a></dt><dd><p>Project: IBM Watson Studio ProjectLib object</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">thread_safe</span></code></dt><dd><p>Check if SQLQuery is in thread-safe mode.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">analyze_cos_url</span></code>(cos_url)</p></td>
<td><p>return a namedtuple containing the 3 fields</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">configure</span></code>([cloud_apikey])</p></td>
<td><p>Update Cloud API key</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.cos.COSClient.connect_project_lib" title="ibmcloudsql.cos.COSClient.connect_project_lib"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect_project_lib</span></code></a>(project[, file_name])</p></td>
<td><p>Connect to an IBM Watson Studio Project’s COS bucket for its own assets</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.cos.COSClient.copy_daily_objects" title="ibmcloudsql.cos.COSClient.copy_daily_objects"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_daily_objects</span></code></a>(source_cos_url, …[, …])</p></td>
<td><p>Copy all objects from a source location in a per day folder on a target location, with a sliding window buffer of days.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.cos.COSClient.copy_objects" title="ibmcloudsql.cos.COSClient.copy_objects"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_objects</span></code></a>(source_path, cos_url)</p></td>
<td><p>Upload a file to a given COS URL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.cos.COSClient.delete_empty_objects" title="ibmcloudsql.cos.COSClient.delete_empty_objects"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_empty_objects</span></code></a>(cos_url)</p></td>
<td><p>Delete zero-size objects.Reference to <a class="reference internal" href="#ibmcloudsql.cos.COSClient.list_cos_objects" title="ibmcloudsql.cos.COSClient.list_cos_objects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list_cos_objects()</span></code></a> for further details..</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.cos.COSClient.delete_objects" title="ibmcloudsql.cos.COSClient.delete_objects"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_objects</span></code></a>(cos_url[, dry_run, confirm, …])</p></td>
<td><p>delete all objects stored at the given COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bucket</span></code>(cos_url)</p></td>
<td><p>return the bucket name from COS URL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.cos.COSClient.get_bucket_info" title="ibmcloudsql.cos.COSClient.get_bucket_info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bucket_info</span></code></a>(cos_url)</p></td>
<td><p>Return the information of the given bucket</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.cos.COSClient.get_cos_summary" title="ibmcloudsql.cos.COSClient.get_cos_summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_cos_summary</span></code></a>(url)</p></td>
<td><p>Return information for the given COR URL (may include bucket + prefix)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_endpoint</span></code>(cos_url)</p></td>
<td><p>return the endpoint string from COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_exact_url</span></code>(cos_url)</p></td>
<td><p>convert COS URL from using alias to exact URL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_prefix</span></code>(cos_url)</p></td>
<td><p>return the prefix part from COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_valid_cos_url</span></code>(cos_url)</p></td>
<td><p>Validate if a string is COS URL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.cos.COSClient.list_cos_objects" title="ibmcloudsql.cos.COSClient.list_cos_objects"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list_cos_objects</span></code></a>(cos_url[, size_unit, …])</p></td>
<td><p>List all objects in the current COS URL.Also, please read the note to see the role of trailing slash in the COS URL..</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logon</span></code>([force])</p></td>
<td><p>Establish a connection to IBM Cloud.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.cos.COSClient.read_project_lib_data" title="ibmcloudsql.cos.COSClient.read_project_lib_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_project_lib_data</span></code></a>([file_name])</p></td>
<td><p>read the content from the given file (via ProjectLib in IBM Watson Studio’s COS bucket)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.cos.COSClient.write_project_lib_data" title="ibmcloudsql.cos.COSClient.write_project_lib_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_project_lib_data</span></code></a>([file_name])</p></td>
<td><p>write the content to the given file (via ProjectLib in IBM Watson Studio’s COS bucket)</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>export_tags_for_cos_objects</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_session</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.connect_project_lib">
<code class="sig-name descname">connect_project_lib</code><span class="sig-paren">(</span><em class="sig-param">project</em>, <em class="sig-param">file_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.connect_project_lib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.connect_project_lib" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to an IBM Watson Studio Project’s COS bucket for its own assets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>project: Project</strong></dt><dd><p>The project-lib object</p>
</dd>
<dt><strong>file_name: str, optional</strong></dt><dd><p>The name of the file in ProjectLib’s COS bucket where data will be read/stored</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.copy_daily_objects">
<code class="sig-name descname">copy_daily_objects</code><span class="sig-paren">(</span><em class="sig-param">source_cos_url</em>, <em class="sig-param">target_cos_url</em>, <em class="sig-param">buffer_days=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.copy_daily_objects"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.copy_daily_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy all objects from a source location in a per day folder on a target location, with a sliding window buffer of days.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>source_cos_url: str</strong></dt><dd><p>Your source data in format cos://us-south/&lt;bucket-name&gt;/object_path/</p>
</dd>
<dt><strong>source_cos_url: str</strong></dt><dd><p>Your target data in format cos://us-south/&lt;bucket-name&gt;/object_path/</p>
</dd>
<dt><strong>buffer_days: sint</strong></dt><dd><p>Number of additional days before and after each day for which to copy the landed objects into the single target day folder.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>if COS URL is invalid</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.copy_objects">
<code class="sig-name descname">copy_objects</code><span class="sig-paren">(</span><em class="sig-param">source_path</em>, <em class="sig-param">cos_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.copy_objects"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.copy_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Upload a file to a given COS URL</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>if COS URL is invalid</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.delete_empty_objects">
<code class="sig-name descname">delete_empty_objects</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.delete_empty_objects"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.delete_empty_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete zero-size objects. Reference to <a class="reference internal" href="#ibmcloudsql.cos.COSClient.list_cos_objects" title="ibmcloudsql.cos.COSClient.list_cos_objects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list_cos_objects()</span></code></a> for further details.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>if COS URL is invalid</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.delete_objects">
<code class="sig-name descname">delete_objects</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em>, <em class="sig-param">dry_run=False</em>, <em class="sig-param">confirm=False</em>, <em class="sig-param">get_result=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.delete_objects"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.delete_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>delete all objects stored at the given COS URL</p>
<p><a class="reference external" href="https:/">https:/</a>/&lt;cos-url&gt;/&lt;bucket&gt;?prefix=&lt;prefix-path&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>confirm: bool, default=False</strong></dt><dd><p>confirm before deleting</p>
</dd>
<dt><strong>get_result: bool, default=True</strong></dt><dd><p>return the result, can be slow on large number of objects</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.DataFrame</dt><dd><p>A single column dataframe: [“Deleted Object”]</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>if COS URL is invalid</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Reference: <a class="reference external" href="https://awsdocs.s3.amazonaws.com/S3/latest/s3-qrc.pdf">AWS doc</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl -XGET                 --url &quot;https://&lt;COS-exact-URL&gt;/&lt;bucket-name&gt;?prefix=&lt;YOUR_PREFIX&gt;&quot;</span>

<span class="go">https://s3.us-south.objectstorage.softlayer.net/sql-query-cos-access-ts?prefix=aiops/Location=us-south/DC=rgdal10/Year=2020/Month=02/Date=06</span>

<span class="go">response.content returns a string in XML format</span>
<span class="go">-----------</span>
<span class="go">(&#39; response = b&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; &#39;</span>
<span class="go">&#39;standalone=&quot;yes&quot;?&gt;&lt;ListBucketResult &#39; &#39;xmlns=&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;&gt;</span>
<span class="go">&lt;Name&gt;sql-query-cos-access-ts&lt;/Name&gt;</span>
<span class="go">&lt;Prefix&gt;aiops/Location=us-south/DC=rgdal10/Year=2020/Month=02/Date=05&lt;/Prefix&gt;</span>
<span class="go">&lt;Marker&gt;&lt;/Marker&gt;</span>
<span class="go">&lt;MaxKeys&gt;1000&lt;/MaxKeys&gt;</span>
<span class="go">&lt;Delimiter&gt;&lt;/Delimiter&gt;</span>
<span class="go">&lt;IsTruncated&gt;false&lt;/IsTruncated&gt;</span>

<span class="go">--&gt; 0 or more</span>
<span class="go">&lt;Contents&gt;</span>
<span class="go">       &lt;Key&gt;aiops/Location=us-south/DC=rgdal10/Year=2020/Month=02/Date=05/Hour=1/part-00066-fd76d4c7-ea0a-40c3-8170-8f281a19ab5f-attempt_20200310232241_0027_m_000066_0.c000.snappy.parquet&lt;/Key&gt;</span>
<span class="go">       &lt;LastModified&gt;2020-03-10T23:26:55.957Z&lt;/LastModified&gt;</span>
<span class="go">       &lt;ETag&gt;&amp;quot;9b9c012a341fe7f4b9988c59cab96757&amp;quot;&lt;/ETag&gt;</span>
<span class="go">       &lt;Size&gt;1771294485&lt;/Size&gt;</span>
<span class="go">       &lt;Owner&gt;</span>
<span class="go">            &lt;ID&gt;899ab340-5a4d-4ae2-a1f7-5e39299735b4&lt;/ID&gt;</span>
<span class="go">            &lt;DisplayName&gt;899ab340-5a4d-4ae2-a1f7-5e39299735b4&lt;/DisplayName&gt;&lt;/Owner&gt;</span>
<span class="go">       &lt;StorageClass&gt;STANDARD&lt;/StorageClass&gt;&lt;/Contents&gt;</span>

<span class="go">&lt;/ListBucketResult&gt;&#39;&#39;)</span>
</pre></div>
</div>
<p>As the entity tag (ETag) is a hash of the object, we can use it to reliably check whether the object has changed - better
than just file size and modification date. Sample code to handle <a class="reference external" href="https://sdbrett.com/BrettsITBlog/2017/03/python-parsing-api-xml-response-data/">request.response</a></p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.export_tags_for_cos_objects">
<code class="sig-name descname">export_tags_for_cos_objects</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em>, <em class="sig-param">export_target_cos_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.export_tags_for_cos_objects"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.export_tags_for_cos_objects" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.get_bucket_info">
<code class="sig-name descname">get_bucket_info</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.get_bucket_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.get_bucket_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the information of the given bucket</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>if invalid COS URL</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl https://config.cloud-object-storage.cloud.ibm.com/v1/b/my-bucket             -H &#39;authorization: bearer &lt;IAM_token&gt;&#39;</span>
</pre></div>
</div>
<p>200 status code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># NOTE: long strings are broken using ( sub1, sub2)</span>
<span class="p">{</span>
<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-new-bucket&quot;</span><span class="p">,</span>
<span class="s2">&quot;crn&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;crn:v1:bluemix:public:cloud-object-storage:global:&quot;</span>
    <span class="s2">&quot;a/ 3bf0d9003abfb5d29761c3e97696b71c:xxxxxxx-6c4f-4a62-a165-696756d63903:bucket:my-new-bucket&quot;</span><span class="p">),</span>
<span class="s2">&quot;service_instance_id&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxx-6c4f-4a62-a165-696756d63903&quot;</span><span class="p">,</span>
<span class="s2">&quot;service_instance_crn&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;crn:v1:bluemix:public:cloud-object-storage:global&quot;</span>
    <span class="s2">&quot;:a/3bf0d9003abfb5d29761c3e97696b71c:xxxxxxx-6c4f-4a62-a165-696756d63903::&quot;</span><span class="p">),</span>
<span class="s2">&quot;time_created&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-03-26T16:23:36.980Z&quot;</span><span class="p">,</span>
<span class="s2">&quot;time_updated&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-10-17T19:29:10.117Z&quot;</span><span class="p">,</span>
<span class="s2">&quot;object_count&quot;</span><span class="p">:</span> <span class="mi">764265234</span><span class="p">,</span>
<span class="s2">&quot;bytes_used&quot;</span><span class="p">:</span> <span class="mi">28198745752445144</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="todo-node-1">
<p class="admonition-title">Todo</p>
<p><a class="reference external" href="https://cloud.ibm.com/apidocs/cos/cos-configuration?code=python">https://cloud.ibm.com/apidocs/cos/cos-configuration?code=python</a></p>
</aside>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.get_cos_summary">
<code class="sig-name descname">get_cos_summary</code><span class="sig-paren">(</span><em class="sig-param">url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.get_cos_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.get_cos_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return information for the given COR URL (may include bucket + prefix)</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>dict</dt><dd><dl class="simple">
<dt>A dict with keys</dt><dd><p>“largest_object”
“largest_object_size”
“newest_object_timestamp”
“oldest_object_timestamp”
“smallest_object”
“smallest_object_size”
“total_objects”
“total_volume”
“url”</p>
</dd>
</dl>
</dd>
<dt>Notes</dt><dd></dd>
</dl>
<blockquote>
<div></div></blockquote>
<dl class="simple">
<dt>Example: self.get_cos_summary_demo()</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.list_cos_objects">
<code class="sig-name descname">list_cos_objects</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em>, <em class="sig-param">size_unit=None</em>, <em class="sig-param">sort_by_size=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.list_cos_objects"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.list_cos_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>List all objects in the current COS URL. Also, please read the note to see the role of trailing slash in the COS URL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>url: str</strong></dt><dd><p>A URI prefix. e.g., cos://us-south/&lt;bucket-name&gt;/object_path/</p>
</dd>
<dt><strong>size_unit: str, optional (“B” = byte)</strong></dt><dd><p>A value indicate the unit of “Size” column.
[“B”, “KB”, “MB”, “GB”]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.DataFrame</dt><dd><p>The following columns (“Object”, “Size”, “StorageClass”)</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>if COS URL is invalid</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Having a trailing slash (/) makes a difference in the returned result, as an asterisk is added at the end. So,
“/prefix” would consider things like “/prefix_unexpected/value” and “/prefix/expected_value”; while
“/prefix/” only consider “/prefix/expected_value”.</p>
<p class="rubric">Examples</p>
<p>Only “list_objects’ work for IBM COS, not ‘list_objects_v2’</p>
<p><a class="reference external" href="https://ibm.github.io/ibm-cos-sdk-python/reference/services/s3.html#S3.Client.list_objects_v2">IBM-COS-SDK</a></p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.project_lib">
<em class="property">property </em><code class="sig-name descname">project_lib</code><a class="headerlink" href="#ibmcloudsql.cos.COSClient.project_lib" title="Permalink to this definition">¶</a></dt>
<dd><p>IBM Watson Studio ProjectLib object</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Project</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.read_project_lib_data">
<code class="sig-name descname">read_project_lib_data</code><span class="sig-paren">(</span><em class="sig-param">file_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.read_project_lib_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.read_project_lib_data" title="Permalink to this definition">¶</a></dt>
<dd><p>read the content from the given file (via ProjectLib in IBM Watson Studio’s COS bucket)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_name: str, optional</strong></dt><dd><p>If not specified, use the one defined from the beginning</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.COSClient.write_project_lib_data">
<code class="sig-name descname">write_project_lib_data</code><span class="sig-paren">(</span><em class="sig-param">file_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#COSClient.write_project_lib_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.COSClient.write_project_lib_data" title="Permalink to this definition">¶</a></dt>
<dd><p>write the content to the given file (via ProjectLib in IBM Watson Studio’s COS bucket)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_name: str, optional</strong></dt><dd><p>If not specified, use the one defined from the beginning</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ibmcloudsql.cos.ParsedUrl">
<em class="property">class </em><code class="sig-prename descclassname">ibmcloudsql.cos.</code><code class="sig-name descname">ParsedUrl</code><a class="reference internal" href="_modules/ibmcloudsql/cos.html#ParsedUrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.ParsedUrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Use this class to extract information from COS URL</p>
<p><cite>cos://&lt;cos-name&gt;/&lt;bucket&gt;/&lt;prefix&gt;/</cite></p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.cos.ParsedUrl.analyze_cos_url" title="ibmcloudsql.cos.ParsedUrl.analyze_cos_url"><code class="xref py py-obj docutils literal notranslate"><span class="pre">analyze_cos_url</span></code></a>(cos_url)</p></td>
<td><p>return a namedtuple containing the 3 fields</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.cos.ParsedUrl.get_bucket" title="ibmcloudsql.cos.ParsedUrl.get_bucket"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bucket</span></code></a>(cos_url)</p></td>
<td><p>return the bucket name from COS URL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.cos.ParsedUrl.get_endpoint" title="ibmcloudsql.cos.ParsedUrl.get_endpoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_endpoint</span></code></a>(cos_url)</p></td>
<td><p>return the endpoint string from COS URL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.cos.ParsedUrl.get_exact_url" title="ibmcloudsql.cos.ParsedUrl.get_exact_url"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_exact_url</span></code></a>(cos_url)</p></td>
<td><p>convert COS URL from using alias to exact URL</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.cos.ParsedUrl.get_prefix" title="ibmcloudsql.cos.ParsedUrl.get_prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_prefix</span></code></a>(cos_url)</p></td>
<td><p>return the prefix part from COS URL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.cos.ParsedUrl.is_valid_cos_url" title="ibmcloudsql.cos.ParsedUrl.is_valid_cos_url"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_valid_cos_url</span></code></a>(cos_url)</p></td>
<td><p>Validate if a string is COS URL</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ibmcloudsql.cos.ParsedUrl.analyze_cos_url">
<code class="sig-name descname">analyze_cos_url</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#ParsedUrl.analyze_cos_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.ParsedUrl.analyze_cos_url" title="Permalink to this definition">¶</a></dt>
<dd><p>return a namedtuple containing the 3 fields</p>
<ul class="simple">
<li><p>bucket</p></li>
<li><p>endpoint</p></li>
<li><p>prefix</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cos_url</strong><span class="classifier">str</span></dt><dd><p>COS URL</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.ParsedUrl.get_bucket">
<code class="sig-name descname">get_bucket</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#ParsedUrl.get_bucket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.ParsedUrl.get_bucket" title="Permalink to this definition">¶</a></dt>
<dd><p>return the bucket name from COS URL</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.ParsedUrl.get_endpoint">
<code class="sig-name descname">get_endpoint</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#ParsedUrl.get_endpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.ParsedUrl.get_endpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>return the endpoint string from COS URL</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.ParsedUrl.get_exact_url">
<code class="sig-name descname">get_exact_url</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#ParsedUrl.get_exact_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.ParsedUrl.get_exact_url" title="Permalink to this definition">¶</a></dt>
<dd><p>convert COS URL from using alias to exact URL</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.ParsedUrl.get_prefix">
<code class="sig-name descname">get_prefix</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#ParsedUrl.get_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.ParsedUrl.get_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>return the prefix part from COS URL</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.ParsedUrl.is_valid_cos_url">
<code class="sig-name descname">is_valid_cos_url</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#ParsedUrl.is_valid_cos_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.ParsedUrl.is_valid_cos_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate if a string is COS URL</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ibmcloudsql.cos.ProjectLib">
<em class="property">class </em><code class="sig-prename descclassname">ibmcloudsql.cos.</code><code class="sig-name descname">ProjectLib</code><span class="sig-paren">(</span><em class="sig-param">project</em>, <em class="sig-param">file_name</em>, <em class="sig-param">file_type='json'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#ProjectLib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.ProjectLib" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This is used by SQLClient/COSClient via <a class="reference internal" href="#ibmcloudsql.cos.ProjectLib.read" title="ibmcloudsql.cos.ProjectLib.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> and <a class="reference internal" href="#ibmcloudsql.cos.ProjectLib.write" title="ibmcloudsql.cos.ProjectLib.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a> methods</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>project: project_lib.Project</strong></dt><dd><p>The object</p>
<blockquote>
<div><p><cite>from project_lib import Project</cite></p>
</div></blockquote>
</dd>
<dt><strong>file_name: str</strong></dt><dd><p>The file_name where the data about SQL queries’ jobs should be read/stored</p>
<p>The content of this file is used to track progress</p>
</dd>
<dt><strong>file_type: str, optional</strong></dt><dd><p>The file format of <cite>file_name</cite></p>
</dd>
<dt><strong>.. todo::</strong></dt><dd><p>NOTE: Currently support only one file</p>
<p>To support many files, we can switch to using dict such as self._data_out[file_name]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><a class="reference internal" href="#ibmcloudsql.cos.ProjectLib.data" title="ibmcloudsql.cos.ProjectLib.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a></dt><dd><p>file-like object: storing the file-content</p>
</dd>
<dt><a class="reference internal" href="#ibmcloudsql.cos.ProjectLib.project" title="ibmcloudsql.cos.ProjectLib.project"><code class="xref py py-obj docutils literal notranslate"><span class="pre">project</span></code></a></dt><dd><p>Project: the project-lib object</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.cos.ProjectLib.read" title="ibmcloudsql.cos.ProjectLib.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>([file_name, file_type])</p></td>
<td><p>Read from project-lib’s file into file-like object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.cos.ProjectLib.write" title="ibmcloudsql.cos.ProjectLib.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>([file_name, file_type])</p></td>
<td><p>Write the file-like data back to project-lib’s file</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ibmcloudsql.cos.ProjectLib.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#ibmcloudsql.cos.ProjectLib.data" title="Permalink to this definition">¶</a></dt>
<dd><p>storing the file-content</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>file-like object</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.ProjectLib.project">
<em class="property">property </em><code class="sig-name descname">project</code><a class="headerlink" href="#ibmcloudsql.cos.ProjectLib.project" title="Permalink to this definition">¶</a></dt>
<dd><p>the project-lib object</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Project</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.ProjectLib.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param">file_name=None</em>, <em class="sig-param">file_type='json'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#ProjectLib.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.ProjectLib.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read from project-lib’s file into file-like object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_name: str, optional</strong></dt><dd><p>File name in the Watson Studio’s project assets. If the file is not provided, then it reads the one passed into the object’s constructor.</p>
</dd>
<dt><strong>file_type: str, optional</strong></dt><dd><p>The type of file, “json” or “csv”</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>file-like object:</dt><dd><p>The content of the data, in dict (json) or pd.DataFrame (csv)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.cos.ProjectLib.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">file_name=None</em>, <em class="sig-param">file_type='json'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/cos.html#ProjectLib.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.cos.ProjectLib.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the file-like data back to project-lib’s file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_name: str</strong></dt><dd><p>File name</p>
</dd>
<dt><strong>file_type: str, optional</strong></dt><dd><p>The type of file, “json” or “csv”</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——</strong></dt><dd></dd>
<dt><strong>dict</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;asset_id&#39;</span><span class="p">:</span> <span class="s1">&#39;1deebaad-8ad3-4861-8c52-e714d8eef2a9&#39;</span><span class="p">,</span>
<span class="s1">&#39;bucket_name&#39;</span><span class="p">:</span> <span class="s1">&#39;projectlib351fb93e171c44369663ff79b938828d&#39;</span><span class="p">,</span>
<span class="s1">&#39;file_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iris1.csv&#39;</span><span class="p">,</span>
<span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;File iris1.csv has been written successfully to the associated OS&#39;</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-ibmcloudsql.exceptions">
<span id="exceptions-module"></span><h2>Exceptions module<a class="headerlink" href="#module-ibmcloudsql.exceptions" title="Permalink to this headline">¶</a></h2>
<dl class="exception">
<dt id="ibmcloudsql.exceptions.CosUrlInaccessibleException">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">CosUrlInaccessibleException</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#CosUrlInaccessibleException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.CosUrlInaccessibleException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>The error when the Cloud-Object Storage (COS) URL being used is not accessible</p>
</dd></dl>

<dl class="exception">
<dt id="ibmcloudsql.exceptions.CosUrlNotFoundException">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">CosUrlNotFoundException</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#CosUrlNotFoundException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.CosUrlNotFoundException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>The error when the Cloud-Object Storage (COS) URL being used is invalid or not accessible</p>
</dd></dl>

<dl class="exception">
<dt id="ibmcloudsql.exceptions.InternalError502Exception">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">InternalError502Exception</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#InternalError502Exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.InternalError502Exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>The error when SQL Query returns a 502 internal error</p>
</dd></dl>

<dl class="exception">
<dt id="ibmcloudsql.exceptions.RateLimitedException">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">RateLimitedException</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#RateLimitedException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.RateLimitedException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>The error when number of requests exceeds the capacity</p>
</dd></dl>

<dl class="exception">
<dt id="ibmcloudsql.exceptions.SqlQueryCreateTableException">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">SqlQueryCreateTableException</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#SqlQueryCreateTableException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.SqlQueryCreateTableException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ibmcloudsql.exceptions.SqlQueryFailException" title="ibmcloudsql.exceptions.SqlQueryFailException"><code class="xref py py-class docutils literal notranslate"><span class="pre">ibmcloudsql.exceptions.SqlQueryFailException</span></code></a></p>
<p>The error raised when a running create-table sql job fails</p>
</dd></dl>

<dl class="exception">
<dt id="ibmcloudsql.exceptions.SqlQueryCrnInvalidFormatException">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">SqlQueryCrnInvalidFormatException</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#SqlQueryCrnInvalidFormatException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.SqlQueryCrnInvalidFormatException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>The error when the SQL Query CRN is not correct</p>
</dd></dl>

<dl class="exception">
<dt id="ibmcloudsql.exceptions.SqlQueryDropTableException">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">SqlQueryDropTableException</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#SqlQueryDropTableException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.SqlQueryDropTableException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ibmcloudsql.exceptions.SqlQueryFailException" title="ibmcloudsql.exceptions.SqlQueryFailException"><code class="xref py py-class docutils literal notranslate"><span class="pre">ibmcloudsql.exceptions.SqlQueryFailException</span></code></a></p>
<p>The error raised when a running drop-table sql job fails</p>
</dd></dl>

<dl class="exception">
<dt id="ibmcloudsql.exceptions.SqlQueryFailException">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">SqlQueryFailException</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#SqlQueryFailException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.SqlQueryFailException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>The error raised when a running sql job fails, e.g. timeout</p>
</dd></dl>

<dl class="exception">
<dt id="ibmcloudsql.exceptions.SqlQueryInvalidFormatException">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">SqlQueryInvalidFormatException</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#SqlQueryInvalidFormatException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.SqlQueryInvalidFormatException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ibmcloudsql.exceptions.SqlQueryFailException" title="ibmcloudsql.exceptions.SqlQueryFailException"><code class="xref py py-class docutils literal notranslate"><span class="pre">ibmcloudsql.exceptions.SqlQueryFailException</span></code></a></p>
<p>The error raised when the format of COS URL is not valid</p>
</dd></dl>

<dl class="exception">
<dt id="ibmcloudsql.exceptions.SqlQueryInvalidPlanException">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">SqlQueryInvalidPlanException</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#SqlQueryInvalidPlanException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.SqlQueryInvalidPlanException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>The error when the used feature is not supported by the current service plan -
e.g. need to upgrade to Standard Plan or higher</p>
</dd></dl>

<dl class="exception">
<dt id="ibmcloudsql.exceptions.UnsupportedStorageFormatException">
<em class="property">exception </em><code class="sig-prename descclassname">ibmcloudsql.exceptions.</code><code class="sig-name descname">UnsupportedStorageFormatException</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">original_exception=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/exceptions.html#UnsupportedStorageFormatException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.exceptions.UnsupportedStorageFormatException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>The error when the SQL uses a format of data that has not been supported yet</p>
</dd></dl>

</section>
<section id="module-ibmcloudsql.sql_magic">
<span id="magic-module"></span><h2>Magic module<a class="headerlink" href="#module-ibmcloudsql.sql_magic" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibmcloudsql.sql_magic.SQLBuilder">
<em class="property">class </em><code class="sig-prename descclassname">ibmcloudsql.sql_magic.</code><code class="sig-name descname">SQLBuilder</code><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ibmcloudsql.sql_magic.TimeSeriesSchema" title="ibmcloudsql.sql_magic.TimeSeriesSchema"><code class="xref py py-class docutils literal notranslate"><span class="pre">ibmcloudsql.sql_magic.TimeSeriesSchema</span></code></a></p>
<p>The class supports constructing a full SQL query statement</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">columns_in_unixtime</span></code></dt><dd><p>Return the name of columns whose values are in UNIX timestamp</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.format_" title="ibmcloudsql.sql_magic.SQLBuilder.format_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">format_</span></code></a>()</p></td>
<td><p>Perform string replacement needed so that the final result is a SQL statement that is accepted by IBM Spark SQL</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.from_cos_" title="ibmcloudsql.sql_magic.SQLBuilder.from_cos_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_cos_</span></code></a>(cos_url[, format_type, alias, …])</p></td>
<td><p>FROM &lt;cos-url&gt; STORED AS &lt;format_type&gt; AS type [FIELDS TERMINATED BY delimiter] [AS alias] [, &lt;cos-url&gt; AS type [AS alias]]</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.from_table_" title="ibmcloudsql.sql_magic.SQLBuilder.from_table_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_table_</span></code></a>(table[, alias])</p></td>
<td><p>FROM &lt;table&gt; [AS alias] [, &lt;table&gt; [AS alias]]</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.from_view_" title="ibmcloudsql.sql_magic.SQLBuilder.from_view_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_view_</span></code></a>(sql_stmt)</p></td>
<td><p>FROM (&lt;sql&gt;)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.get_sql" title="ibmcloudsql.sql_magic.SQLBuilder.get_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sql</span></code></a>()</p></td>
<td><p>Return the current sql string</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.group_by_" title="ibmcloudsql.sql_magic.SQLBuilder.group_by_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">group_by_</span></code></a>(columns)</p></td>
<td><p>GROUP BY &lt;columns&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.join_cos_" title="ibmcloudsql.sql_magic.SQLBuilder.join_cos_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">join_cos_</span></code></a>(cos_url, condition[, typ, alias])</p></td>
<td><p>[typ] JOIN &lt;cos-url&gt; [AS alias]</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.join_table_" title="ibmcloudsql.sql_magic.SQLBuilder.join_table_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">join_table_</span></code></a>(table, condition[, typ, alias])</p></td>
<td><p>[typ] JOIN &lt;table&gt; [AS alias] ON &lt;condition&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.order_by_" title="ibmcloudsql.sql_magic.SQLBuilder.order_by_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order_by_</span></code></a>(columns)</p></td>
<td><p>ORDER BY &lt;columns&gt;</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.partition_by_" title="ibmcloudsql.sql_magic.SQLBuilder.partition_by_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">partition_by_</span></code></a>(columns)</p></td>
<td><p>PARTITIONED BY &lt;columns&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.partition_objects_" title="ibmcloudsql.sql_magic.SQLBuilder.partition_objects_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">partition_objects_</span></code></a>(num_objects)</p></td>
<td><p>PARTITIONED INTO &lt;num&gt;  OBJECTS</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.partition_rows_" title="ibmcloudsql.sql_magic.SQLBuilder.partition_rows_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">partition_rows_</span></code></a>(num_rows)</p></td>
<td><p>PARTITIONED INTO &lt;num&gt; ROWS</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.print_sql" title="ibmcloudsql.sql_magic.SQLBuilder.print_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_sql</span></code></a>()</p></td>
<td><p>print() sql string</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.reset_" title="ibmcloudsql.sql_magic.SQLBuilder.reset_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_</span></code></a>()</p></td>
<td><p>Reset and returns the current sql string</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.select_" title="ibmcloudsql.sql_magic.SQLBuilder.select_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_</span></code></a>(columns)</p></td>
<td><p>SELECT &lt;columns&gt;</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.store_at_" title="ibmcloudsql.sql_magic.SQLBuilder.store_at_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">store_at_</span></code></a>(cos_url[, format_type])</p></td>
<td><p>INTO &lt;cos-url&gt; STORED AS &lt;type&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.where_" title="ibmcloudsql.sql_magic.SQLBuilder.where_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">where_</span></code></a>(condition)</p></td>
<td><p>WHERE &lt;condition&gt; [, &lt;condition&gt;]</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.SQLBuilder.with_" title="ibmcloudsql.sql_magic.SQLBuilder.with_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">with_</span></code></a>(table_name, sql_stmt)</p></td>
<td><p>WITH &lt;table&gt; AS &lt;sql&gt; [, &lt;table AS &lt;sql&gt;]</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.format_">
<code class="sig-name descname">format_</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.format_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.format_" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform string replacement needed so that the final result is a SQL statement that is accepted by IBM Spark SQL</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.from_cos_">
<code class="sig-name descname">from_cos_</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em>, <em class="sig-param">format_type='parquet'</em>, <em class="sig-param">alias=None</em>, <em class="sig-param">delimiter=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.from_cos_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.from_cos_" title="Permalink to this definition">¶</a></dt>
<dd><p>FROM &lt;cos-url&gt; STORED AS &lt;format_type&gt; AS type [FIELDS TERMINATED BY delimiter] [AS alias] [, &lt;cos-url&gt; AS type [AS alias]]</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.from_table_">
<code class="sig-name descname">from_table_</code><span class="sig-paren">(</span><em class="sig-param">table</em>, <em class="sig-param">alias=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.from_table_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.from_table_" title="Permalink to this definition">¶</a></dt>
<dd><p>FROM &lt;table&gt; [AS alias] [, &lt;table&gt; [AS alias]]</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.from_view_">
<code class="sig-name descname">from_view_</code><span class="sig-paren">(</span><em class="sig-param">sql_stmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.from_view_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.from_view_" title="Permalink to this definition">¶</a></dt>
<dd><p>FROM (&lt;sql&gt;)</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.get_sql">
<code class="sig-name descname">get_sql</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.get_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.get_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current sql string</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.group_by_">
<code class="sig-name descname">group_by_</code><span class="sig-paren">(</span><em class="sig-param">columns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.group_by_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.group_by_" title="Permalink to this definition">¶</a></dt>
<dd><p>GROUP BY &lt;columns&gt;</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.join_cos_">
<code class="sig-name descname">join_cos_</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em>, <em class="sig-param">condition</em>, <em class="sig-param">typ='inner'</em>, <em class="sig-param">alias=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.join_cos_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.join_cos_" title="Permalink to this definition">¶</a></dt>
<dd><p>[typ] JOIN &lt;cos-url&gt; [AS alias]</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.join_table_">
<code class="sig-name descname">join_table_</code><span class="sig-paren">(</span><em class="sig-param">table</em>, <em class="sig-param">condition</em>, <em class="sig-param">typ='inner'</em>, <em class="sig-param">alias=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.join_table_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.join_table_" title="Permalink to this definition">¶</a></dt>
<dd><p>[typ] JOIN &lt;table&gt; [AS alias] ON &lt;condition&gt;</p>
<p>NOTE: [typ] is a value in the list below</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;INNER&quot;</span><span class="p">,</span> <span class="s2">&quot;CROSS&quot;</span><span class="p">,</span> <span class="s2">&quot;OUTER&quot;</span><span class="p">,</span> <span class="s2">&quot;LEFT&quot;</span><span class="p">,</span> <span class="s2">&quot;LEFT OUTER&quot;</span><span class="p">,</span> <span class="s2">&quot;LEFT SEMI&quot;</span><span class="p">,</span>
<span class="s2">&quot;RIGHT&quot;</span><span class="p">,</span> <span class="s2">&quot;RIGHT OUTER&quot;</span><span class="p">,</span> <span class="s2">&quot;FULL&quot;</span><span class="p">,</span> <span class="s2">&quot;FULL OUTER&quot;</span><span class="p">,</span> <span class="s2">&quot;ANTI&quot;</span><span class="p">,</span> <span class="s2">&quot;LEFT ANTI&quot;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.order_by_">
<code class="sig-name descname">order_by_</code><span class="sig-paren">(</span><em class="sig-param">columns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.order_by_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.order_by_" title="Permalink to this definition">¶</a></dt>
<dd><p>ORDER BY &lt;columns&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>condition: str</strong></dt><dd><p>a string representing a comma-separated list of columns</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.partition_by_">
<code class="sig-name descname">partition_by_</code><span class="sig-paren">(</span><em class="sig-param">columns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.partition_by_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.partition_by_" title="Permalink to this definition">¶</a></dt>
<dd><p>PARTITIONED BY &lt;columns&gt;</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.partition_objects_">
<code class="sig-name descname">partition_objects_</code><span class="sig-paren">(</span><em class="sig-param">num_objects</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.partition_objects_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.partition_objects_" title="Permalink to this definition">¶</a></dt>
<dd><p>PARTITIONED INTO &lt;num&gt;  OBJECTS</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.partition_rows_">
<code class="sig-name descname">partition_rows_</code><span class="sig-paren">(</span><em class="sig-param">num_rows</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.partition_rows_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.partition_rows_" title="Permalink to this definition">¶</a></dt>
<dd><p>PARTITIONED INTO &lt;num&gt; ROWS</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.print_sql">
<code class="sig-name descname">print_sql</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.print_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.print_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>print() sql string</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.reset_">
<code class="sig-name descname">reset_</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.reset_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.reset_" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset and returns the current sql string</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.select_">
<code class="sig-name descname">select_</code><span class="sig-paren">(</span><em class="sig-param">columns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.select_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.select_" title="Permalink to this definition">¶</a></dt>
<dd><p>SELECT &lt;columns&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>columns: str</strong></dt><dd><p>a string representing a comma-separated list of columns</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.store_at_">
<code class="sig-name descname">store_at_</code><span class="sig-paren">(</span><em class="sig-param">cos_url</em>, <em class="sig-param">format_type='CSV'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.store_at_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.store_at_" title="Permalink to this definition">¶</a></dt>
<dd><p>INTO &lt;cos-url&gt; STORED AS &lt;type&gt;</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.where_">
<code class="sig-name descname">where_</code><span class="sig-paren">(</span><em class="sig-param">condition</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.where_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.where_" title="Permalink to this definition">¶</a></dt>
<dd><p>WHERE &lt;condition&gt; [, &lt;condition&gt;]</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.SQLBuilder.with_">
<code class="sig-name descname">with_</code><span class="sig-paren">(</span><em class="sig-param">table_name</em>, <em class="sig-param">sql_stmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#SQLBuilder.with_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.SQLBuilder.with_" title="Permalink to this definition">¶</a></dt>
<dd><p>WITH &lt;table&gt; AS &lt;sql&gt; [, &lt;table AS &lt;sql&gt;]</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ibmcloudsql.sql_magic.TimeSeriesSchema">
<em class="property">class </em><code class="sig-prename descclassname">ibmcloudsql.sql_magic.</code><code class="sig-name descname">TimeSeriesSchema</code><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#TimeSeriesSchema"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.TimeSeriesSchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The class tracks the columns that is useful in time-series handling.
Currently, it tracks column names whose values are in UNIX time format</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#ibmcloudsql.sql_magic.TimeSeriesSchema.columns_in_unixtime" title="ibmcloudsql.sql_magic.TimeSeriesSchema.columns_in_unixtime"><code class="xref py py-obj docutils literal notranslate"><span class="pre">columns_in_unixtime</span></code></a></dt><dd><p>Return the name of columns whose values are in UNIX timestamp</p>
</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="ibmcloudsql.sql_magic.TimeSeriesSchema.columns_in_unixtime">
<em class="property">property </em><code class="sig-name descname">columns_in_unixtime</code><a class="headerlink" href="#ibmcloudsql.sql_magic.TimeSeriesSchema.columns_in_unixtime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the name of columns whose values are in UNIX timestamp</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ibmcloudsql.sql_magic.TimeSeriesTransformInput">
<em class="property">class </em><code class="sig-prename descclassname">ibmcloudsql.sql_magic.</code><code class="sig-name descname">TimeSeriesTransformInput</code><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#TimeSeriesTransformInput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.TimeSeriesTransformInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class contains methods that supports the transformation of a user-friendly arguments in time-series functions
to IBM CloudSQL compatible values.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.TimeSeriesTransformInput.transform_sql" title="ibmcloudsql.sql_magic.TimeSeriesTransformInput.transform_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_sql</span></code></a>(f)</p></td>
<td><p>Generate SQL string</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_magic.TimeSeriesTransformInput.ts_segment_by_time" title="ibmcloudsql.sql_magic.TimeSeriesTransformInput.ts_segment_by_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ts_segment_by_time</span></code></a>(sql_stmt)</p></td>
<td><p>Revise arguments of TS_SEGMENT_BY_TIME function to comply with IBM CloudSQL</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ibmcloudsql.sql_magic.TimeSeriesTransformInput.transform_sql">
<em class="property">classmethod </em><code class="sig-name descname">transform_sql</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#TimeSeriesTransformInput.transform_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.TimeSeriesTransformInput.transform_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate SQL string</p>
<p class="rubric">Notes</p>
<p>Syntax: <a class="reference external" href="https://cloud.ibm.com/docs/sql-query">https://cloud.ibm.com/docs/sql-query</a></p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_magic.TimeSeriesTransformInput.ts_segment_by_time">
<em class="property">classmethod </em><code class="sig-name descname">ts_segment_by_time</code><span class="sig-paren">(</span><em class="sig-param">sql_stmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#TimeSeriesTransformInput.ts_segment_by_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.TimeSeriesTransformInput.ts_segment_by_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Revise arguments of TS_SEGMENT_BY_TIME function to comply with IBM CloudSQL</p>
<p class="rubric">Notes</p>
<p>The TS_SEGMENT_BY_TIME supported by IBM CloudSQL accepts value in number, which is not user-friendly
for units like hour, days, minutes. SQLBuilder alllows constructing SQL query string using
the below values.</p>
<p>1. values: <cite>per_hour</cite>, <cite>hour</cite>, <cite>per_day</cite>, <cite>day</cite>, <cite>per_week</cite>, <cite>week</cite>,
<cite>minute</cite>, <cite>Xminute</cite> (X is a number divisible by 60)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ts_segment_by_time(ts, per_hour, per_hour)</span>
<span class="go">ts_segment_by_time(ts, hour, hour)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><dl class="simple">
<dt>or values: using  ISO 8601 <a class="reference external" href="https://en.wikipedia.org/wiki/ISO_8601#Durations">https://en.wikipedia.org/wiki/ISO_8601#Durations</a></dt><dd><p>P[n]Y[n]M[n]DT[n]H[n]M[n]S or P[n]W</p>
</dd>
</dl>
</li>
</ol>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ts_segment_by_time</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">PT1H</span><span class="p">,</span> <span class="n">PT1H</span><span class="p">)</span>
</pre></div>
</div>
<p>into</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ts_segment_by_time</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="mi">3600000</span><span class="p">,</span> <span class="mi">3600000</span><span class="p">)</span>
</pre></div>
</div>
<p>as ts_segment_by_time operates at mili-seconds level, hour=60*60*1000 miliseconds</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibmcloudsql.sql_magic.format_sql">
<code class="sig-prename descclassname">ibmcloudsql.sql_magic.</code><code class="sig-name descname">format_sql</code><span class="sig-paren">(</span><em class="sig-param">sql_stmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#format_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.format_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>format SQL string to ensure proper content for string comparison</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sql_stmt: str</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibmcloudsql.sql_magic.print_sql">
<code class="sig-prename descclassname">ibmcloudsql.sql_magic.</code><code class="sig-name descname">print_sql</code><span class="sig-paren">(</span><em class="sig-param">sql_stmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_magic.html#print_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_magic.print_sql" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-ibmcloudsql.sql_query_ts">
<span id="time-series-sql-query-module"></span><h2>Time-Series SQL Query module<a class="headerlink" href="#module-ibmcloudsql.sql_query_ts" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibmcloudsql.sql_query_ts.SQLClientTimeSeries">
<em class="property">class </em><code class="sig-prename descclassname">ibmcloudsql.sql_query_ts.</code><code class="sig-name descname">SQLClientTimeSeries</code><span class="sig-paren">(</span><em class="sig-param">api_key=''</em>, <em class="sig-param">instance_crn=''</em>, <em class="sig-param">target_cos_url=None</em>, <em class="sig-param">max_concurrent_jobs=4</em>, <em class="sig-param">max_tries=1</em>, <em class="sig-param">iam_max_tries=1</em>, <em class="sig-param">thread_safe=False</em>, <em class="sig-param">client_info='TimeSeries Cloud SQL Query Python'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_query_ts.html#SQLClientTimeSeries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SQLQuery.SQLQuery</span></code></p>
<p>This class augments SQLClient with time-series functionality</p>
<p>HISTORY:
Aug-10-2021: expand _get_ts_datasource_v3()</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">columns_in_unixtime</span></code></dt><dd><p>Return the name of columns whose values are in UNIX timestamp</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">cos_session</span></code></dt><dd><p>Get the current COS session.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">my_jobs</span></code></dt><dd><p>Return information about jobs already queried via <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_job" title="ibmcloudsql.SQLQuery.SQLQuery.get_job"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_job()</span></code></a></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">project_lib</span></code></dt><dd><p>Project: IBM Watson Studio ProjectLib object</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">target_url</span></code></dt><dd><p>Return the target COS URL.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">thread_safe</span></code></dt><dd><p>Check if SQLQuery is in thread-safe mode.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_partitions</span></code>(table_name, col_names)</p></td>
<td><p>Update the table with a partition column having new value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">analyze</span></code>(job_id[, print_msg])</p></td>
<td><p>Provides some insights about the data layout from the current SQL statement</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">analyze_cos_url</span></code>(cos_url)</p></td>
<td><p>return a namedtuple containing the 3 fields</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">configure</span></code>([apikey, instance_crn, cos_out_url])</p></td>
<td><p>update the configuration</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect_project_lib</span></code>(project[, file_name])</p></td>
<td><p>Connect to an IBM Watson Studio Project’s COS bucket for its own assets</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_daily_objects</span></code>(source_cos_url, …[, …])</p></td>
<td><p>Copy all objects from a source location in a per day folder on a target location, with a sliding window buffer of days.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_objects</span></code>(source_path, cos_url)</p></td>
<td><p>Upload a file to a given COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_metaindex</span></code>(table_name)</p></td>
<td><p>Create a metaindex for a given table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_partitioned_table</span></code>(table_name[, …])</p></td>
<td><p>Create a partitioned table for data on COS.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_table</span></code>(table_name[, cos_url, …])</p></td>
<td><p>Create a table for data on COS.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_empty_objects</span></code>(cos_url)</p></td>
<td><p>Delete zero-size objects.Reference to <a class="reference internal" href="#ibmcloudsql.cos.COSClient.list_cos_objects" title="ibmcloudsql.cos.COSClient.list_cos_objects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list_cos_objects()</span></code></a> for further details..</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_objects</span></code>(cos_url[, dry_run, confirm, …])</p></td>
<td><p>delete all objects stored at the given COS URL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_result</span></code>(jobId)</p></td>
<td><p>Delete the COS objects created by a given job-id</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">describe_table</span></code>(table_name)</p></td>
<td><p>Return the schema of a table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_all_tables</span></code>()</p></td>
<td><p>Delete all created tables in the project.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_table</span></code>([table_name])</p></td>
<td><p>Drop a given table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_tables</span></code>(table_names)</p></td>
<td><p>Drop a list of tables.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.execute_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.execute_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute_sql</span></code></a>(*args, **kwargs)</p></td>
<td><p>Extend the behavior of <a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.run_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.run_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_sql()</span></code></a>.It is a blocking call that waits for the job to finish (unlike <a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit_sql()</span></code></a>), but it has the following features:.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">export_job_history</span></code>([cos_url, …])</p></td>
<td><p>Export the most recent jobs to COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">format_</span></code>()</p></td>
<td><p>Perform string replacement needed so that the final result is a SQL statement that is accepted by IBM Spark SQL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_cos_</span></code>(cos_url[, format_type, alias, …])</p></td>
<td><p>FROM &lt;cos-url&gt; STORED AS &lt;format_type&gt; AS type [FIELDS TERMINATED BY delimiter] [AS alias] [, &lt;cos-url&gt; AS type [AS alias]]</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_table_</span></code>(table[, alias])</p></td>
<td><p>FROM &lt;table&gt; [AS alias] [, &lt;table&gt; [AS alias]]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_view_</span></code>(sql_stmt)</p></td>
<td><p>FROM (&lt;sql&gt;)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bucket</span></code>(cos_url)</p></td>
<td><p>return the bucket name from COS URL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bucket_info</span></code>(cos_url)</p></td>
<td><p>Return the information of the given bucket</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_cos_summary</span></code>(url)</p></td>
<td><p>Return information for the given COR URL (may include bucket + prefix)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_endpoint</span></code>(cos_url)</p></td>
<td><p>return the endpoint string from COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_exact_url</span></code>(cos_url)</p></td>
<td><p>convert COS URL from using alias to exact URL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_job</span></code>(jobId)</p></td>
<td><p>Return the details of the job-id</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_jobs</span></code>()</p></td>
<td><p>Return the up-to-30 most recent jobs from the given Cloud API</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_jobs_count_with_status</span></code>(status)</p></td>
<td><p>return the number of jobs in the SQL Query server for the given <cite>status</cite></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_jobs_with_status</span></code>(job_id_list, status)</p></td>
<td><p>return the list of job_id, among those provided, that have the given status</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metaindex</span></code>(table_name)</p></td>
<td><p>Get the metaindex of a table.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_number_running_jobs</span></code>()</p></td>
<td><p>return the number of running jobs in the SQL Query server</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_prefix</span></code>(cos_url)</p></td>
<td><p>return the prefix part from COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_result</span></code>(jobId[, pagenumber])</p></td>
<td><p>Return the queried data from the given job-id</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_schema_data</span></code>(cos_url[, typ, dry_run])</p></td>
<td><p>Return the schema of COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_schema_table</span></code>(table_name)</p></td>
<td><p>Return the schema of table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sql</span></code>()</p></td>
<td><p>Return the current sql string</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.get_ts_datasource" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.get_ts_datasource"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_ts_datasource</span></code></a>(cos_in, key, time_stamp, …)</p></td>
<td><p>Prepare the data source for time-series in the next-query, in that the result is broken down into multiple objects using <cite>num_objects</cite> as the criteria</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.get_ts_datasource_from_table" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.get_ts_datasource_from_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_ts_datasource_from_table</span></code></a>(table_name, …)</p></td>
<td><p>Prepare the data source for time-series in the next-query, in that the result is broken down into multiple objects using <cite>num_objects</cite> as the criteria</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">group_by_</span></code>(columns)</p></td>
<td><p>GROUP BY &lt;columns&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.human_form_to_machine_form" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.human_form_to_machine_form"><code class="xref py py-obj docutils literal notranslate"><span class="pre">human_form_to_machine_form</span></code></a>(sql_stmt)</p></td>
<td><p>apply magic tricks to convert some useful names, e.g.hour, day, …to the expected numeric value in [ms] - which is the expected input to TimeSeries functions in SQL.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_a_supported_storage_type</span></code>(typ)</p></td>
<td><p>check if a type is in a supported format</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_valid_cos_url</span></code>(cos_url)</p></td>
<td><p>Validate if a string is COS URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">join_cos_</span></code>(cos_url, condition[, typ, alias])</p></td>
<td><p>[typ] JOIN &lt;cos-url&gt; [AS alias]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">join_table_</span></code>(table, condition[, typ, alias])</p></td>
<td><p>[typ] JOIN &lt;table&gt; [AS alias] ON &lt;condition&gt;</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">list_cos_objects</span></code>(cos_url[, size_unit, …])</p></td>
<td><p>List all objects in the current COS URL.Also, please read the note to see the role of trailing slash in the COS URL..</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">list_results</span></code>(jobId[, wait])</p></td>
<td><p>NOTE: A single SQL Query can store the queried data in the COS output in multiple objects/partitions</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logon</span></code>([force])</p></td>
<td><p>Establish a connection to IBM Cloud.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">order_by_</span></code>(columns)</p></td>
<td><p>ORDER BY &lt;columns&gt;</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">partition_by_</span></code>(columns)</p></td>
<td><p>PARTITIONED BY &lt;columns&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">partition_objects_</span></code>(num_objects)</p></td>
<td><p>PARTITIONED INTO &lt;num&gt;  OBJECTS</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">partition_rows_</span></code>(num_rows)</p></td>
<td><p>PARTITIONED INTO &lt;num&gt; ROWS</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_sql</span></code>()</p></td>
<td><p>print() sql string</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">process_failed_jobs_until_all_completed</span></code>(…)</p></td>
<td><p>re-send those that are failed - due to the time-out mechanism of SQL Query server</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_project_lib_data</span></code>([file_name])</p></td>
<td><p>read the content from the given file (via ProjectLib in IBM Watson Studio’s COS bucket)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">recover_table_partitions</span></code>(table_name)</p></td>
<td><p>Update a partitioned table.This step is required after creating a new partitioned table..</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rename_exact_result</span></code>(jobId[, wait])</p></td>
<td><p>A SQL Query can store data into partitioned/paginated multiple objects, or single object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rename_exact_result_joblist</span></code>(job_list[, wait])</p></td>
<td><p>The bulk mode of <cite>rename_exact_result</cite> method.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_</span></code>()</p></td>
<td><p>Reset and returns the current sql string</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>([pagesize, get_result])</p></td>
<td><p>run the internal SQL statement provided by SQLBuilder using <a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.execute_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.execute_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute_sql()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.run_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.run_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_sql</span></code></a>(*args, **kwargs)</p></td>
<td><p>Submits a SQL job, waits for the job to finish (unlike <a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit_sql()</span></code></a>) and return the result as Pandas DataFrame.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_</span></code>(columns)</p></td>
<td><p>SELECT &lt;columns&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_tracking_file</span></code>(file_name)</p></td>
<td><p>provides the file name which is used for tracking multiple SQL requests</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">show_tables</span></code>([target_cos_url, pattern])</p></td>
<td><p>List the available Hive Metastore.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sql_ui_link</span></code>()</p></td>
<td><p>both print out and also return the string containing SQL Query URL</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">store_at_</span></code>(cos_url[, format_type])</p></td>
<td><p>INTO &lt;cos-url&gt; STORED AS &lt;type&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">submit</span></code>([pagesize])</p></td>
<td><p>run the internal SQL statement that you created using the APIs provided by SQLBuilder</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">submit_and_track_sql</span></code>(sql_stmt[, pagesize, …])</p></td>
<td><p>Each SQL Query instance is limited by the number of sql queries that it can handle at a time.This can be a problem when you launch many SQL Query jobs, as such limitation may prevent you to complete all of them in one session.The <cite>max_tries</cite> options when creating the SQL Query client object allows you to re-send the job, which is still limited to one session.The time for one session is often limited when when using SQL Query client via Watson Studio, i.e.you will lose the session after having no interaction with the notebook for a period of time..</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">submit_sql</span></code></a>(*args, **kwargs)</p></td>
<td><p>Asynchronous call - submit and quickly return the job_id.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">wait_for_job</span></code>(jobId[, sleep_time])</p></td>
<td><p>It’s possible that the job’s failed because of Spark’s internal error which does not have any status.So “unknown” is added for such cases..</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">where_</span></code>(condition)</p></td>
<td><p>WHERE &lt;condition&gt; [, &lt;condition&gt;]</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">with_</span></code>(table_name, sql_stmt)</p></td>
<td><p>WITH &lt;table&gt; AS &lt;sql&gt; [, &lt;table AS &lt;sql&gt;]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_project_lib_data</span></code>([file_name])</p></td>
<td><p>write the content to the given file (via ProjectLib in IBM Watson Studio’s COS bucket)</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>export_tags_for_cos_objects</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_session</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.execute_sql">
<code class="sig-name descname">execute_sql</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_query_ts.html#SQLClientTimeSeries.execute_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.execute_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>Extend the behavior of <a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.run_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.run_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_sql()</span></code></a>.
It is a blocking call that waits for the job to finish (unlike <a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit_sql()</span></code></a>), but it has the following features:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>returning of data (Pandas dataframe) is optional (controlled by <cite>get_result</cite> parameter): to help avoiding Python runtime memory overload.</dt><dd><p>This is also useful when you run SQL statements such as DDLs that don’t produce results at all.</p>
</dd>
</dl>
</li>
<li><p>returns a namedtuple, in that result.data is the one returned by <cite>run_sql</cite>, while result.job_id is the one returned by <cite>submit_sql</cite></p></li>
<li><p>raise an exception for a failed job</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sql_stmt: str</strong></dt><dd><p>the SQL statement to run</p>
</dd>
<dt><strong>pagesize: int, optional</strong></dt><dd><p>an integer indicating the number of rows for each partition/page [using PARTITIONED EVERY &lt;pagesize&gt; ROWS syntax]</p>
</dd>
<dt><strong>get_result: bool, optional (default=False)</strong></dt><dd><p>When set it will return only the job_id, but still wait for the job’s completion.
Later, you can get the data using <a class="reference internal" href="#ibmcloudsql.SQLQuery.SQLQuery.get_result" title="ibmcloudsql.SQLQuery.SQLQuery.get_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_result()</span></code></a> (job_id, pagenumber)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>namedtuple [<cite>data</cite>, <cite>job_id</cite>]</dt><dd><dl class="simple">
<dt><cite>get_result</cite> = True, then behavior like <a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.run_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.run_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_sql()</span></code></a> which materializes the returned data as type</dt><dd><p>pd.DataFrame in memory. The default behavior is opposite, to avoid unintended overload of memory.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>KeyError</dt><dd><p>when information about a failed job is missing (job_status, job_id, error, error_message)</p>
</dd>
<dt>SqlQueryFailException</dt><dd><p>when the sql query fails, e.g. time out on the server side</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.get_ts_datasource">
<code class="sig-name descname">get_ts_datasource</code><span class="sig-paren">(</span><em class="sig-param">cos_in</em>, <em class="sig-param">key</em>, <em class="sig-param">time_stamp</em>, <em class="sig-param">observation</em>, <em class="sig-param">cos_out</em>, <em class="sig-param">granularity='raw'</em>, <em class="sig-param">where_clause=''</em>, <em class="sig-param">ops='avg'</em>, <em class="sig-param">dry_run=False</em>, <em class="sig-param">keep_col_names: bool = True</em>, <em class="sig-param">cast_observation=None</em>, <em class="sig-param">num_objects=20</em>, <em class="sig-param">print_warning=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_query_ts.html#SQLClientTimeSeries.get_ts_datasource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.get_ts_datasource" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the data source for time-series in the next-query, in that the result is
broken down into multiple objects using <cite>num_objects</cite> as the criteria</p>
<dl class="simple">
<dt>It will returns the data source in 3 columns:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>keep_col_names &lt;- False: use exact values below</dt><dd><p>field_name, time_stamp, observation</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>keep_col_names &lt;- True: use the values passed via arguments</dt><dd><p>&lt;key&gt;, &lt;time_stamp&gt;, &lt;observation&gt;</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cos_in: str</strong></dt><dd><p>The data source in “COS_URL stored as &lt;format&gt;”</p>
</dd>
<dt><strong>key: str</strong></dt><dd><p>The column name being used as the key</p>
</dd>
<dt><strong>time_stamp: str</strong></dt><dd><p>The column name being used as timestick</p>
</dd>
<dt><strong>observation: str</strong></dt><dd><p>The column name being used as value</p>
</dd>
<dt><strong>cast_observation: str, optional=None</strong></dt><dd><p>The type to be casted for the <cite>observation</cite> column</p>
</dd>
<dt><strong>cos_out: str</strong></dt><dd><p>The COS URL where the data is copied to - later as data source</p>
</dd>
<dt><strong>granularity: str</strong></dt><dd><p>a value in one of [“raw”, “per_min”, “per_&lt;x&gt;min”, “per_sec”, “per_&lt;x&gt;sec”]
with &lt;x&gt; is a number divided by 60, e.g. 10, 15</p>
</dd>
<dt><strong>dry_run: bool, optional</strong></dt><dd><p>This option, once selected as True, returns the internally generated SQL statement, and no job is queried.</p>
</dd>
<dt><strong>num_objects: int, optional</strong></dt><dd><p>The number of objects to be created for storing the data</p>
</dd>
<dt><strong>print_warning: bool, default=True</strong></dt><dd><p>print a warning or not</p>
</dd>
<dt><strong>keep_col_names: bool, optional (False)</strong></dt><dd><p>By default, all 3 original column names are maintained.
If you set to false, they are mapped to <cite>field_name</cite> (for key),
<cite>time_stamp</cite> and <cite>observation</cite>, respectively.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>The COS_URL where the data with 3 fields (key, time_stamp, observation)
and can be digested into time-series via TIME_SERIES_FORMAT(key, timestick, value)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.get_ts_datasource_from_table">
<code class="sig-name descname">get_ts_datasource_from_table</code><span class="sig-paren">(</span><em class="sig-param">table_name</em>, <em class="sig-param">key</em>, <em class="sig-param">time_stamp</em>, <em class="sig-param">observation</em>, <em class="sig-param">cos_out</em>, <em class="sig-param">granularity='raw'</em>, <em class="sig-param">where_clause=''</em>, <em class="sig-param">ops='avg'</em>, <em class="sig-param">dry_run=False</em>, <em class="sig-param">keep_col_names: bool = True</em>, <em class="sig-param">cast_observation=None</em>, <em class="sig-param">num_objects=20</em>, <em class="sig-param">print_warning=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_query_ts.html#SQLClientTimeSeries.get_ts_datasource_from_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.get_ts_datasource_from_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the data source for time-series in the next-query, in that the result is
broken down into multiple objects using <cite>num_objects</cite> as the criteria</p>
<dl class="simple">
<dt>It will returns the data source in 3 columns:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>keep_col_names &lt;- False: use exact values below</dt><dd><p>field_name, time_stamp, observation</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>keep_col_names &lt;- True: use the values passed via arguments</dt><dd><p>&lt;key&gt;, &lt;time_stamp&gt;, &lt;observation&gt;</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>table: str</strong></dt><dd><p>The catalog table name
NOTE: Use either <cite>cos_in</cite> or <cite>table</cite>, but not both</p>
</dd>
<dt><strong>key: str</strong></dt><dd><p>The column name being used as the key</p>
</dd>
<dt><strong>time_stamp: str</strong></dt><dd><p>The column name being used as timestick</p>
</dd>
<dt><strong>observation: str</strong></dt><dd><p>The column name being used as value</p>
</dd>
<dt><strong>cast_observation: str, optional=None</strong></dt><dd><p>The type to be casted for the <cite>observation</cite> column</p>
</dd>
<dt><strong>cos_out: str</strong></dt><dd><p>The COS URL where the data is copied to - later as data source</p>
</dd>
<dt><strong>granularity: str</strong></dt><dd><p>a value in one of [“raw”, “per_min”, “per_&lt;x&gt;min”, “per_sec”, “per_&lt;x&gt;sec”]
with &lt;x&gt; is a number divided by 60, e.g. 10, 15</p>
</dd>
<dt><strong>dry_run: bool, optional</strong></dt><dd><p>This option, once selected as True, returns the internally generated SQL statement, and no job is queried.</p>
</dd>
<dt><strong>num_objects: int, optional</strong></dt><dd><p>The number of objects to be created for storing the data</p>
</dd>
<dt><strong>print_warning: bool, default=True</strong></dt><dd><p>print a warning or not</p>
</dd>
<dt><strong>keep_col_names: bool, optional (False)</strong></dt><dd><p>By default, all 3 original column names are maintained.
If you set to false, they are mapped to <cite>field_name</cite> (for key),
<cite>time_stamp</cite> and <cite>observation</cite>, respectively.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>The COS_URL where the data with 3 fields (key, time_stamp, observation)
and can be digested into time-series via TIME_SERIES_FORMAT(key, timestick, value)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.human_form_to_machine_form">
<code class="sig-name descname">human_form_to_machine_form</code><span class="sig-paren">(</span><em class="sig-param">sql_stmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_query_ts.html#SQLClientTimeSeries.human_form_to_machine_form"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.human_form_to_machine_form" title="Permalink to this definition">¶</a></dt>
<dd><p>apply magic tricks to convert some useful names, e.g. hour, day, … to the expected numeric value in [ms] - which is the expected input to TimeSeries functions in SQL</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.run_sql">
<code class="sig-name descname">run_sql</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_query_ts.html#SQLClientTimeSeries.run_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.run_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>Submits a SQL job, waits for the job to finish (unlike <a class="reference internal" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql" title="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql"><code class="xref py py-meth docutils literal notranslate"><span class="pre">submit_sql()</span></code></a>) and return the result as Pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sql_text: str</strong></dt><dd><p>the SQL statement to run</p>
</dd>
<dt><strong>pagesize: int, optional</strong></dt><dd><p>an integer indicating the number of rows for each partition/page [using PARTITIONED EVERY &lt;pagesize&gt; ROWS syntax]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.DataFrame with the query results.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>CosUrlNotFoundException</dt><dd><p>the COS URL is not valid</p>
</dd>
<dt>CosUrlInaccessibleException</dt><dd><p>the COS URL is inaccessible - no access granted to the given API key</p>
</dd>
<dt>SqlQueryInvalidFormatException</dt><dd><p>the format provided to COS URL is incorrect</p>
</dd>
<dt>KeyError</dt><dd><p>the returned error message does not have job_id, error, or error_message</p>
</dd>
<dt>Exception</dt><dd><p>unexpected exception</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql">
<code class="sig-name descname">submit_sql</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_query_ts.html#SQLClientTimeSeries.submit_sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_query_ts.SQLClientTimeSeries.submit_sql" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronous call - submit and quickly return the job_id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sql_stmt: str</strong></dt><dd><p>SQL Query string</p>
</dd>
<dt><strong>pagesize: int, optional</strong></dt><dd><p>an integer indicating the number of rows for each partition/page
[using PARTITIONED EVERY &lt;pagesize&gt; ROWS syntax]</p>
</dd>
<dt><strong>stored_as: string</strong></dt><dd><p>The type being used, only if ‘INTO … STORED AS …’ is not provided</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>job_id</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>RateLimitedException</dt><dd><p>when the SQLQUery instance is serving the max-limit of requests</p>
</dd>
<dt>SyntaxError</dt><dd><p>for both KeyError or HTTPError</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl -XPOST                 --url &quot;https://api.sql-query.cloud.ibm.com/v2/sql_jobs?instance_crn=YOUR_SQL_QUERY_CRN&quot;                 -H &quot;Accept: application/json&quot;                 -H &quot;Authorization: Bearer YOUR_BEARER_TOKEN&quot;                 -H &quot;Content-Type: application/json&quot;                 -d &#39;{&quot;statement&quot;:&quot;SELECT firstname FROM cos://us-geo/sql/employees.parquet STORED AS PARQUET WHERE EMPLOYEEID=5 INTO cos://us-geo/target-bucket/q1-results&quot; }&#39;</span>
</pre></div>
</div>
<p>NOTE:</p>
<p>1. All the headers (-H) can be put into a dictionary and
passed to the <em>headers</em> argument of requests.post() API.</p>
<p>2. All the data (-d option) is put into a dictionary and
passed to the <em>json</em> argument of requests.post() API.</p>
<blockquote>
<div><ul class="simple">
<li><p>‘statement’: value is full SQL statement in string</p></li>
<li><p>‘resultset_target’ (optional): only need when there is no ‘INTO statement’ in the query string, and the value must be the COS URL output</p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sqlData</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;statement&#39;</span><span class="p">:</span> <span class="n">sql_stmt</span><span class="p">}</span>
<span class="n">request_headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">}</span>
<span class="n">request_headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;Accept&#39;</span><span class="p">:</span><span class="s1">&#39;application/json&#39;</span><span class="p">})</span>
<span class="n">request_headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="p">})</span>
<span class="n">request_headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;authorization&#39;</span><span class="p">:</span> <span class="s1">&#39;Bearer </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ro_credentials</span><span class="o">.</span><span class="n">token</span><span class="p">)})</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="s2">&quot;https://api.sql-query.cloud.ibm.com/v2/sql_jobs?instance_crn=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance_crn</span><span class="p">),</span>
    <span class="n">headers</span><span class="o">=</span><span class="n">request_headers</span><span class="p">,</span>
    <span class="n">json</span><span class="o">=</span><span class="n">sqlData</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">{</span>
<span class="sd">    &quot;errors&quot;: [</span>
<span class="sd">        {</span>
<span class="sd">        &quot;code&quot;: &quot;bad_request&quot;,</span>
<span class="sd">        &quot;message&quot;: &quot;Target url specified in parameter resultset_target and as part of into clause in statement&quot;</span>
<span class="sd">        }</span>
<span class="sd">    ]</span>
<span class="sd">}</span>
<span class="sd">{</span>
<span class="sd">    &quot;job_id&quot;: &quot;e2adca0a-9247-4cfa-ac58-db4b2bc33a01&quot;,</span>
<span class="sd">    &quot;status&quot;: &quot;queued&quot;</span>
<span class="sd">}</span>
<span class="sd">{</span>
<span class="sd">    &quot;status_code&quot;: 429,</span>
<span class="sd">    &quot;errors&quot;: [</span>
<span class="sd">        {</span>
<span class="sd">        &quot;code&quot;: &quot;too_many_requests&quot;,</span>
<span class="sd">        &quot;message&quot;: &quot;This instance is currently running its maximum number of query jobs. Try again later, after at least one of the currently running jobs has completed.&quot;</span>
<span class="sd">        }</span>
<span class="sd">    ]</span>
<span class="sd">}</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># error code information: https://cloud.ibm.com/apidocs/sql-query</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibmcloudsql.sql_query_ts.test_run">
<code class="sig-prename descclassname">ibmcloudsql.sql_query_ts.</code><code class="sig-name descname">test_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/sql_query_ts.html#test_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.sql_query_ts.test_run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-ibmcloudsql.utilities">
<span id="utilities-module"></span><h2>Utilities module<a class="headerlink" href="#module-ibmcloudsql.utilities" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ibmcloudsql.utilities.IBMCloudAccess">
<em class="property">class </em><code class="sig-prename descclassname">ibmcloudsql.utilities.</code><code class="sig-name descname">IBMCloudAccess</code><span class="sig-paren">(</span><em class="sig-param">cloud_apikey=''</em>, <em class="sig-param">client_info=''</em>, <em class="sig-param">staging=False</em>, <em class="sig-param">thread_safe=False</em>, <em class="sig-param">session=None</em>, <em class="sig-param">iam_max_tries: int = 1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/utilities.html#IBMCloudAccess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.utilities.IBMCloudAccess" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class provides APIs to get credentials to interact with IBM Cloud services, e.g. COS, SQL Query</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cloud_apikey</strong><span class="classifier">str, optional</span></dt><dd><p>an account-level API key [manage/Access (IAM)/IBM Cloud API keys]</p>
</dd>
<dt><strong>client_info</strong><span class="classifier">str, optional</span></dt><dd><p>a description</p>
</dd>
<dt><strong>thread_safe: bool, optional</strong></dt><dd><p>a new Session object is created if not provided</p>
</dd>
<dt><strong>session: ibm_boto3.session.Session, optional</strong></dt><dd><p>provide a Session object so that it can be reused</p>
</dd>
<dt><strong>staging: bool, optional</strong></dt><dd><p>if True, then uses the test IAM endpoint</p>
</dd>
<dt><strong>iam_max_tries: int, optional</strong></dt><dd><p>Number of tries to connect to IAM service</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><a class="reference internal" href="#ibmcloudsql.utilities.IBMCloudAccess.cos_session" title="ibmcloudsql.utilities.IBMCloudAccess.cos_session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cos_session</span></code></a></dt><dd><p>Get the current COS session.</p>
</dd>
<dt><a class="reference internal" href="#ibmcloudsql.utilities.IBMCloudAccess.thread_safe" title="ibmcloudsql.utilities.IBMCloudAccess.thread_safe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">thread_safe</span></code></a></dt><dd><p>Check if SQLQuery is in thread-safe mode.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibmcloudsql.utilities.IBMCloudAccess.configure" title="ibmcloudsql.utilities.IBMCloudAccess.configure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">configure</span></code></a>([cloud_apikey])</p></td>
<td><p>Update Cloud API key</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibmcloudsql.utilities.IBMCloudAccess.logon" title="ibmcloudsql.utilities.IBMCloudAccess.logon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">logon</span></code></a>([force])</p></td>
<td><p>Establish a connection to IBM Cloud.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>get_session</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ibmcloudsql.utilities.IBMCloudAccess.configure">
<code class="sig-name descname">configure</code><span class="sig-paren">(</span><em class="sig-param">cloud_apikey=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/utilities.html#IBMCloudAccess.configure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.utilities.IBMCloudAccess.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>Update Cloud API key</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.utilities.IBMCloudAccess.cos_session">
<em class="property">property </em><code class="sig-name descname">cos_session</code><a class="headerlink" href="#ibmcloudsql.utilities.IBMCloudAccess.cos_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current COS session.</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.utilities.IBMCloudAccess.get_session">
<code class="sig-name descname">get_session</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/utilities.html#IBMCloudAccess.get_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.utilities.IBMCloudAccess.get_session" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ibmcloudsql.utilities.IBMCloudAccess.logon">
<code class="sig-name descname">logon</code><span class="sig-paren">(</span><em class="sig-param">force=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/utilities.html#IBMCloudAccess.logon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.utilities.IBMCloudAccess.logon" title="Permalink to this definition">¶</a></dt>
<dd><p>Establish a connection to IBM Cloud.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>AttributeError:</dt><dd><p>The exception is raised when the token cannot be retrieved using the current credential.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>An AIM token is needed for any operations to IBM cloud services (e.g. COS)
A new AIM token is created after 300 seconds.
A token is valid for 3600 seconds</p>
</dd></dl>

<dl class="method">
<dt id="ibmcloudsql.utilities.IBMCloudAccess.thread_safe">
<em class="property">property </em><code class="sig-name descname">thread_safe</code><a class="headerlink" href="#ibmcloudsql.utilities.IBMCloudAccess.thread_safe" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if SQLQuery is in thread-safe mode.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ibmcloudsql.utilities.confirm_action">
<code class="sig-prename descclassname">ibmcloudsql.utilities.</code><code class="sig-name descname">confirm_action</code><span class="sig-paren">(</span><em class="sig-param">action_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/utilities.html#confirm_action"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.utilities.confirm_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Ask user to enter Y or N (case-insensitive).
:return: True if the answer is Y.
:rtype: bool</p>
</dd></dl>

<dl class="function">
<dt id="ibmcloudsql.utilities.rename_keys">
<code class="sig-prename descclassname">ibmcloudsql.utilities.</code><code class="sig-name descname">rename_keys</code><span class="sig-paren">(</span><em class="sig-param">d</em>, <em class="sig-param">keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/utilities.html#rename_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.utilities.rename_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename keys from <cite>d</cite> that are present as a key in <cite>keys</cite> by the
corresponding value in <cite>keys</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>{dict} --</strong><strong> [</strong><strong>a dict whose certain keys need to be updated</strong><strong>]</strong> (<em>d</em>) – </p></li>
<li><p><strong>{dict} --</strong><strong> [</strong><strong>a dict that map old key to new key</strong><strong>]</strong> (<em>keys</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[dict] – [an updated dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ibmcloudsql.utilities.static_vars">
<code class="sig-prename descclassname">ibmcloudsql.utilities.</code><code class="sig-name descname">static_vars</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ibmcloudsql/utilities.html#static_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibmcloudsql.utilities.static_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>use this as a decorator to a function to assign default value to static variable, e.g. var_stat</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@static_vars</span><span class="p">(</span><span class="n">var_stat</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="n">func</span><span class="o">.</span><span class="n">var_stat</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">var_stat</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>IMPORTANT: Inside the function, access to the variable should be using the function name, e.g. func.var_stat</p>
</dd></dl>

</section>
<section id="module-ibmcloudsql">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ibmcloudsql" title="Permalink to this headline">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020, IBM Research.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/ibmcloudsql.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>